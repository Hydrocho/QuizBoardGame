<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>PWA ëª¨ë°”ì¼ ë³´ë“œê²Œì„</title>
    <meta name="description" content="ì¹œêµ¬ë“¤ê³¼ í•¨ê»˜ ì¦ê¸°ëŠ” ì¬ë¯¸ìˆëŠ” ëª¨ë°”ì¼ ë³´ë“œê²Œì„">
    <meta name="theme-color" content="#4CAF50">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            margin: 0 !important;
            padding: 0 !important;
            width: 100%;
            height: 100%;
        }

        :root {
            --color-start: #FF7F50;
            --color-quiz: #00CED1;
            --color-golden: #FFD700;
            --color-special: #6495ED;
            --color-corner: #4682B4;
            --color-center: #E0F6FF;
            --color-background: #F0F8FF;
            --color-normal: #B0E0E6;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--color-background) 0%, var(--color-normal) 100%);
            min-height: 100vh;
            overflow: hidden;
        }

        .game-container {
            width: 100vw;
            height: 100vh;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        /* ì¤‘ì•™ UI íŒ¨ë„ */
        .center-panel {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            padding: 20px 30px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            width: 70vw;
            max-width: 650px;
            min-width: 320px;
            z-index: 5;
        }


        .players-section {
            display: flex;
            gap: 15px;
            justify-content: center;
            align-items: center;
            width: 100%;
            margin-bottom: 15px;
            flex-wrap: nowrap;
        }

        .player-info {
            display: flex;
            flex-direction: row;
            align-items: center;
            gap: 10px;
            background: rgba(255, 255, 255, 0.9);
            padding: 12px 14px;
            border-radius: 15px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            min-width: 150px;
            flex: 1;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .player-info.active {
            border: 2px solid #FFD700;
            animation: playerBlink 1s infinite;
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }

        @keyframes playerBlink {
            0% { 
                border-color: #FFD700;
                box-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
            }
            50% { 
                border-color: #FFA500;
                box-shadow: 0 0 15px rgba(255, 165, 0, 0.8);
            }
            100% { 
                border-color: #FFD700;
                box-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
            }
        }

        .controls-section {
            display: flex;
            align-items: center;
            gap: 15px;
            justify-content: center;
            width: 100%;
            margin-top: 10px;
        }

        .dice-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .player-avatar {
            width: 45px;
            height: 45px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 18px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
            flex-shrink: 0;
        }

        .player-details {
            display: flex;
            flex-direction: column;
            gap: 2px;
            align-items: flex-start;
            flex: 1;
        }

        .player-name {
            font-weight: bold;
            color: #333;
            font-size: 14px;
        }

        .player-score {
            font-size: 12px;
            color: #666;
        }

        .player-lands {
            font-size: 11px;
            color: #888;
        }

        .golden-keys {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 12px;
            color: #FFD700;
        }

        .game-status {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .status-badge {
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .phase-badge {
            background: rgba(76, 175, 80, 0.9);
            color: white;
        }

        .turn-badge {
            background: rgba(255, 193, 7, 0.9);
            color: #333;
        }

        /* ê²Œì„ ë³´ë“œ */
        .board-container {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: stretch;
            padding: 2px 5vw;
            overflow: hidden;
            position: relative;
        }

        .game-board {
            width: 85vw;
            height: calc(100% - 4px);
            max-width: 85vw;
            aspect-ratio: 1.4 / 1;
            border: 4px solid var(--color-corner);
            border-radius: 20px;
            background: var(--color-center);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            position: relative;
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            grid-template-rows: repeat(7, 1fr);
            gap: 0px;
            padding: 0px;
        }

        .board-space {
            border-radius: 0px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: none;
            min-height: 25px;
            border: 1px solid rgba(0, 0, 0, 0.1);
        }

        .board-space:hover {
            transform: scale(1.02);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        /* ë‚´ë¶€ ë¹ˆì¹¸ë“¤ì„ ìœ„í•œ íŠ¹ë³„ ìŠ¤íƒ€ì¼ - ëª¨ë“  ê·¸ë¦¼ìì™€ í…Œë‘ë¦¬ ì œê±° */
        .board-space.center-background {
            border: none !important;
            box-shadow: none !important;
            outline: none !important;
        }

        .board-space.center-background:hover {
            transform: none !important;
            box-shadow: none !important;
        }

        /* ì¤‘ì•™ ë°°ê²½ ì¹¸ë“¤ - í˜¸ë²„ íš¨ê³¼ ë¹„í™œì„±í™” */
        .board-space.center-background {
            cursor: default !important;
            pointer-events: none !important; /* ë§ˆìš°ìŠ¤ ì´ë²¤íŠ¸ ì™„ì „ ì°¨ë‹¨ */
        }

        .board-space.center-background:hover {
            transform: none !important;
            box-shadow: none !important;
            cursor: default !important;
        }

        /* ì¤‘ì•™ íŒ¨ë„ê³¼ ê²¹ì¹˜ëŠ” ì˜ì—­ì˜ ëª¨ë“  ì¹¸ë“¤ - í˜¸ë²„ íš¨ê³¼ ë¹„í™œì„±í™” */
        .board-space:nth-child(16),  /* (2,2) */
        .board-space:nth-child(17),  /* (2,3) */
        .board-space:nth-child(18),  /* (2,4) */
        .board-space:nth-child(23),  /* (3,2) */
        .board-space:nth-child(24),  /* (3,3) */
        .board-space:nth-child(25),  /* (3,4) */
        .board-space:nth-child(30),  /* (4,2) */
        .board-space:nth-child(31),  /* (4,3) */
        .board-space:nth-child(32) { /* (4,4) */
            cursor: default !important;
        }

        .board-space:nth-child(16):hover,
        .board-space:nth-child(17):hover,
        .board-space:nth-child(18):hover,
        .board-space:nth-child(23):hover,
        .board-space:nth-child(24):hover,
        .board-space:nth-child(25):hover,
        .board-space:nth-child(30):hover,
        .board-space:nth-child(31):hover,
        .board-space:nth-child(32):hover {
            transform: none !important;
            box-shadow: none !important;
            cursor: default !important;
        }

        /* ëª¨ë…¸í´ë¦¬ ìŠ¤íƒ€ì¼ ì§€ì—­ë³„ ìƒ‰ìƒ ë  */
        .board-space::after {
            content: '';
            position: absolute;
            background: var(--ribbon-color, transparent);
            z-index: 2; /* í”Œë ˆì´ì–´ ë§(z-index: 10)ë³´ë‹¤ ì•„ë˜, ì¹¸ ë°°ê²½ë³´ë‹¤ ìœ„ */
            transition: background-color 0.3s ease;
        }

        /* 1ë²ˆ í”Œë ˆì´ì–´ ì§€ì—­ (ì¹¸ 1, 2, 4, 5) - ìƒë‹¨ ë  */
        .board-space[data-space="1"]::after,
        .board-space[data-space="2"]::after,
        .board-space[data-space="4"]::after,
        .board-space[data-space="5"]::after {
            top: 0;
            left: 0;
            right: 0;
            height: 9px; /* ë†’ì´ë¥¼ 1.5ë°°ë¡œ ì¦ê°€ */
            border-radius: 4.5px 4.5px 0 0;
        }

        /* 2ë²ˆ í”Œë ˆì´ì–´ ì§€ì—­ (ì¹¸ 7, 8, 10, 11) - ì˜¤ë¥¸ìª½ ë  */
        .board-space[data-space="7"]::after,
        .board-space[data-space="8"]::after,
        .board-space[data-space="10"]::after,
        .board-space[data-space="11"]::after {
            top: 0;
            right: 0;
            bottom: 0;
            width: 9px; /* ë„ˆë¹„ë¥¼ 1.5ë°°ë¡œ ì¦ê°€ */
            border-radius: 0 4.5px 4.5px 0;
        }

        /* 3ë²ˆ í”Œë ˆì´ì–´ ì§€ì—­ (ì¹¸ 13, 14, 16, 17) - í•˜ë‹¨ ë  */
        .board-space[data-space="13"]::after,
        .board-space[data-space="14"]::after,
        .board-space[data-space="16"]::after,
        .board-space[data-space="17"]::after {
            bottom: 0;
            left: 0;
            right: 0;
            height: 9px; /* ë†’ì´ë¥¼ 1.5ë°°ë¡œ ì¦ê°€ */
            border-radius: 0 0 4.5px 4.5px;
        }

        /* 4ë²ˆ í”Œë ˆì´ì–´ ì§€ì—­ (ì¹¸ 19, 20, 22, 23) - ì™¼ìª½ ë  */
        .board-space[data-space="19"]::after,
        .board-space[data-space="20"]::after,
        .board-space[data-space="22"]::after,
        .board-space[data-space="23"]::after {
            top: 0;
            left: 0;
            bottom: 0;
            width: 9px; /* ë„ˆë¹„ë¥¼ 1.5ë°°ë¡œ ì¦ê°€ */
            border-radius: 4.5px 0 0 4.5px;
        }

        .space-number {
            font-size: clamp(8px, 2vw, 16px);
            font-weight: bold;
            color: white;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
        }

        .space-name {
            font-size: clamp(6px, 1.5vw, 12px);
            color: white;
            text-align: center;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
            margin-top: 1px;
            line-height: 1;
        }

        /* ëª¨ë…¸í´ë¦¬ ìŠ¤íƒ€ì¼ ë³´ë“œ ì¹¸ ë°°ì¹˜ */
        .corner-space {
            background: var(--color-corner) !important;
            color: white;
            font-weight: bold;
            border: 2px solid var(--color-corner) !important;
            font-size: 12px;
        }

        .side-space {
            min-height: 20px;
        }

        .center-space {
            background: var(--color-center) !important;
            color: #000;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            border: 2px solid var(--color-corner);
        }

        .player-piece {
            position: absolute;
            width: 25px;
            height: 25px;
            border-radius: 8px;
            border: 2px solid white;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
            font-weight: bold;
            transition: all 0.5s ease;
            top: 8%; /* ë ì§€ì™€ ê²¹ì¹˜ì§€ ì•Šë„ë¡ ìœ„ì¹˜ ì¡°ì • */
            background: rgba(0, 0, 0, 0.2); /* ë°°ê²½ì„ ì¡°ê¸ˆ ë” ì§„í•˜ê²Œ í•˜ì—¬ ê°€ì‹œì„± í–¥ìƒ */
            z-index: 10; /* ë ì§€(z-index: 2)ë³´ë‹¤ ìœ„ì— í‘œì‹œ */
        }

        .player-piece.moving {
            animation: bounceMove 0.6s ease-in-out;
            z-index: 20;
        }

        @keyframes bounceMove {
            0% {
                transform: translateY(0px) scale(1);
            }
            25% { 
                transform: translateY(-15px) scale(1.1);
            }
            50% { 
                transform: translateY(0px) scale(1);
            }
            75% { 
                transform: translateY(-8px) scale(1.05);
            }
            100% { 
                transform: translateY(0px) scale(1);
            }
        }

        .player-piece.landing {
            animation: landingBounce 0.4s ease-out;
        }

        @keyframes landingBounce {
            0% {
                transform: translateY(0px) scale(1);
            }
            50% {
                transform: translateY(-10px) scale(1.15);
            }
            100% {
                transform: translateY(0px) scale(1);
            }
        }

        /* ì „ì²´í™”ë©´ ë²„íŠ¼ */
        .fullscreen-button {
            position: absolute;
            top: 15px;
            right: 15px;
            width: 45px;
            height: 45px;
            background: rgba(255, 255, 255, 0.98);
            border: 3px solid #333;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 20px;
            color: #333;
            transition: all 0.3s ease;
            z-index: 1000;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
        }

        /* ì„¤ì • ë²„íŠ¼ */
        .settings-button {
            position: absolute;
            top: 70px;
            right: 15px;
            width: 45px;
            height: 45px;
            background: rgba(255, 255, 255, 0.98);
            border: 3px solid #333;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 20px;
            color: #333;
            transition: all 0.3s ease;
            z-index: 1000;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
        }

        .fullscreen-button:hover {
            background: rgba(255, 255, 255, 1);
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        /* ì„¤ì • ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
        .settings-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .settings-container {
            background: white;
            border-radius: 8px;
            width: 95%;
            max-width: 900px;
            height: 85%;
            max-height: 650px;
            display: flex;
            flex-direction: column;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .settings-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 16px;
            border-bottom: 1px solid #e9ecef;
            background: #f8f9fa;
            border-radius: 8px 8px 0 0;
        }

        .settings-header h2 {
            margin: 0;
            color: #333;
            font-size: 18px;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: #666;
            padding: 4px 8px;
            border-radius: 4px;
            transition: background 0.3s ease;
        }

        .close-btn:hover {
            background: #e9ecef;
        }

        .settings-content {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        .settings-sidebar {
            width: 160px;
            background: #f8f9fa;
            border-right: 1px solid #e9ecef;
            padding: 8px 0;
            overflow-y: auto;
        }

        .sidebar-item {
            padding: 8px 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            border-left: 3px solid transparent;
            font-size: 13px;
        }

        .sidebar-item:hover {
            background: #e3f2fd;
        }

        .sidebar-item.active {
            background: #bbdefb;
            border-left-color: #2196f3;
            font-weight: bold;
        }

        .settings-main {
            flex: 1;
            padding: 12px;
            overflow-y: auto;
        }

        .settings-panel {
            display: none;
        }

        .settings-panel.active {
            display: block;
        }

        .settings-panel h3 {
            margin: 0 0 8px 0;
            color: #333;
            font-size: 16px;
        }

        .setting-group {
            margin: 4px 0;
            padding: 6px;
            background: #f8f9fa;
            border-radius: 6px;
        }

        .setting-group label {
            display: block;
            margin-bottom: 4px;
            font-weight: bold;
            color: #333;
            font-size: 14px;
        }

        .volume-slider {
            width: 100%;
            margin: 6px 0;
        }

        .volume-value {
            color: #666;
            font-size: 14px;
        }

        .palette-list {
            display: flex;
            flex-direction: column;
            gap: 6px;
            margin-top: 4px;
        }

        .palette-item {
            display: flex;
            align-items: center;
            padding: 8px 12px;
            border: 2px solid transparent;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            min-height: 32px;
        }

        .palette-item:hover {
            background: #e3f2fd;
        }

        .palette-item.active {
            border-color: #2196f3;
            background: #bbdefb;
        }

        .palette-name {
            font-weight: 500;
            color: #333;
            font-size: 14px;
            line-height: 1.2;
            width: 100%;
        }

        /* ìƒ‰ìƒ ì„¤ì • 2ë‹¨ ë ˆì´ì•„ì›ƒ */
        .color-settings-layout {
            display: flex;
            gap: 12px;
            height: 100%;
        }

        .palette-selection {
            flex: 1;
            min-width: 0;
        }

        .palette-preview {
            flex: 2;
            min-width: 0;
            background: #f8f9fa;
            border-radius: 6px;
            padding: 10px;
            display: flex;
            flex-direction: column;
        }

        .palette-preview h4 {
            margin: 0 0 8px 0;
            color: #333;
            font-size: 14px;
        }

        .mini-board-container {
            background: white;
            border-radius: 6px;
            padding: 8px;
            margin-bottom: 8px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .mini-board {
            width: 200px;
            height: 150px;
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            grid-template-rows: repeat(7, 1fr);
            gap: 1px;
            background: #333;
            border-radius: 6px;
            padding: 2px;
        }

        .mini-space {
            background: #fff;
            border-radius: 2px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 8px;
            font-weight: bold;
            color: #333;
        }

        .palette-info {
            margin-bottom: 15px;
        }

        .palette-info .palette-name {
            font-size: 18px;
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }

        .palette-info .palette-theme {
            font-size: 14px;
            color: #666;
            margin-bottom: 10px;
            font-style: italic;
        }

        .palette-colors {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
        }

        .color-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
        }

        .color-swatch {
            width: 20px;
            height: 20px;
            border-radius: 4px;
            border: 1px solid #ddd;
        }

        .preview-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .btn-apply, .btn-cancel {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .btn-apply {
            background: #2196f3;
            color: white;
        }

        .btn-apply:hover {
            background: #1976d2;
        }

        .btn-cancel {
            background: #f5f5f5;
            color: #666;
        }

        .btn-cancel:hover {
            background: #e0e0e0;
        }

        /* ëª¨ë°”ì¼ ë°˜ì‘í˜• */
        @media (max-width: 768px) {
            .settings-container {
                width: 95%;
                height: 90%;
            }
            
            .settings-content {
                flex-direction: column;
            }
            
            .settings-sidebar {
                width: 100%;
                height: auto;
                max-height: 120px;
                flex-direction: row;
                overflow-x: auto;
                padding: 10px;
                border-right: none;
                border-bottom: 1px solid #e9ecef;
            }
            
            .sidebar-item {
                min-width: 80px;
                text-align: center;
                padding: 10px 5px;
                border-left: none;
                border-bottom: 3px solid transparent;
            }
            
            .sidebar-item.active {
                border-left: none;
                border-bottom-color: #2196f3;
            }
            
            
            .color-settings-layout {
                flex-direction: column;
            }
            
            .palette-preview {
                width: 100%;
                min-width: auto;
            }
            
            .mini-board {
                width: 150px;
                height: 120px;
            }
        }

        .fullscreen-button:active {
            transform: scale(0.95);
        }

        .settings-button:hover {
            background: rgba(255, 255, 255, 1);
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .settings-button:active {
            transform: scale(0.95);
        }

        .fullscreen-icon {
            position: relative;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* ê¸°ë³¸ ìƒíƒœ: í™•ëŒ€ ì•„ì´ì½˜ í‘œì‹œ, ì¶•ì†Œ ì•„ì´ì½˜ ìˆ¨ê¹€ */
        .fullscreen-icon .expand-icon {
            display: block;
        }

        .fullscreen-icon .minimize-icon {
            display: none;
        }

        /* ì „ì²´í™”ë©´ ìƒíƒœ: í™•ëŒ€ ì•„ì´ì½˜ ìˆ¨ê¹€, ì¶•ì†Œ ì•„ì´ì½˜ í‘œì‹œ */
        .fullscreen-icon.minimize .expand-icon {
            display: none;
        }

        .fullscreen-icon.minimize .minimize-icon {
            display: block;
        }

        /* SVG ì•„ì´ì½˜ ìŠ¤íƒ€ì¼ */
        .fullscreen-icon svg {
            transition: all 0.2s ease;
        }

        .fullscreen-button:hover .fullscreen-icon svg {
            transform: scale(1.1);
        }

        /* ì „ì²´í™”ë©´ ëª¨ë“œì¼ ë•Œ */
        .fullscreen-mode {
            margin: 0 !important;
            padding: 0 !important;
        }

        .fullscreen-mode .board-container {
            padding: 2px 2vw !important;
            margin: 0 !important;
        }

        .fullscreen-mode .game-board {
            width: 95vw;
            height: calc(100% - 4px);
            margin: 0 !important;
        }

        .fullscreen-mode .center-panel {
            width: 75vw;
            max-width: 750px;
            min-width: 400px;
        }


        /* ìƒˆë¡œìš´ SVG ê¸°ë°˜ ì£¼ì‚¬ìœ„ ìŠ¤íƒ€ì¼ */
        .dice-display {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .dice-icon {
            width: 64px;
            height: 64px;
            fill: #374151;
        }

        /* ì£¼ì‚¬ìœ„ í‘œì‹œ ì˜ì—­ì˜ ì£¼ì‚¬ìœ„ ì•„ì´ì½˜ ìŠ¤íƒ€ì¼ */
        #diceIcon {
            fill: #374151;
        }

        .dice-icon.spinning {
            animation: spin 0.1s linear infinite;
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .control-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 25px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
        }

        .control-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }

        .control-button:active {
            transform: translateY(0);
        }

        .control-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* íŒì—… ìŠ¤íƒ€ì¼ */
        .popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }

        .popup-overlay.show {
            display: flex;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .popup-container {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            padding: 30px;
            max-width: 90vw;
            max-height: 80vh;
            width: 500px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            animation: slideUp 0.3s ease;
            overflow-y: auto;
        }

        @keyframes slideUp {
            from { 
                opacity: 0;
                transform: translateY(50px);
            }
            to { 
                opacity: 1;
                transform: translateY(0);
            }
        }

        .popup-title {
            color: white;
            text-align: center;
            margin: 0 0 20px 0;
            font-size: 24px;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .popup-content {
            color: white;
            text-align: center;
            margin: 0 0 25px 0;
            font-size: 16px;
            line-height: 1.5;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
        }

        .popup-button {
            background: white;
            color: #333;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            margin: 10px 0;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
            min-height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .popup-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
            background: #f8f9fa;
        }

        /* ë°˜ì‘í˜• ë””ìì¸ */
        
        /* ì „ì²´í™”ë©´ ë²„íŠ¼ ë°˜ì‘í˜• */
        @media (max-width: 768px) {
            .fullscreen-button {
                width: 35px;
                height: 35px;
                font-size: 16px;
                top: 8px;
                right: 8px;
            }
            .settings-button {
                width: 35px;
                height: 35px;
                font-size: 16px;
                top: 50px;
                right: 8px;
            }
        }

        @media (max-width: 480px) {
            .fullscreen-button {
                width: 30px;
                height: 30px;
                font-size: 14px;
                top: 5px;
                right: 5px;
            }
            .settings-button {
                width: 30px;
                height: 30px;
                font-size: 14px;
                top: 40px;
                right: 5px;
            }
        }
        
        /* ì¤‘ê°„ í¬ê¸° í™”ë©´ - 2ì¤„ ë°°ì¹˜ (2x2) */
        @media (max-width: 900px) {
            .center-panel {
                padding: 15px 20px;
                gap: 12px;
                width: 65vw;
                max-width: 450px;
                min-width: 300px;
            }
            
            .players-section {
                gap: 8px;
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .player-info {
                min-width: 180px;
                padding: 10px 12px;
                gap: 10px;
                flex: 1 1 calc(50% - 4px);
                max-width: calc(50% - 4px);
            }
            
            .player-avatar {
                width: 40px;
                height: 40px;
                font-size: 16px;
            }
            
            .player-name {
                font-size: 13px;
            }
            
            .player-score {
                font-size: 12px;
            }
            
            .player-lands {
                font-size: 11px;
            }
            
            .controls-section {
                gap: 10px;
            }
            
            .game-board {
                width: 85vw;
                height: calc(100% - 4px);
                aspect-ratio: 1.4 / 1;
            }
        }

        /* íƒœë¸”ë¦¿ í¬ê¸° - 2ì¤„ ë°°ì¹˜ ìœ ì§€ */
        @media (max-width: 768px) {
            .center-panel {
                padding: 15px 18px;
                gap: 10px;
                width: 60vw;
                max-width: 400px;
                min-width: 280px;
            }
            
            .players-section {
                gap: 6px;
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .player-info {
                min-width: 160px;
                padding: 8px 10px;
                gap: 8px;
                flex: 1 1 calc(50% - 3px);
                max-width: calc(50% - 3px);
            }
            
            .player-avatar {
                width: 36px;
                height: 36px;
                font-size: 15px;
            }
            
            .player-name {
                font-size: 12px;
            }
            
            .player-score {
                font-size: 11px;
            }
            
            .player-lands {
                font-size: 10px;
            }
            
            .controls-section {
                gap: 8px;
            }
            
            .game-board {
                width: 85vw;
                height: calc(100% - 4px);
                aspect-ratio: 1.4 / 1;
            }
        }

        /* ì‘ì€ í™”ë©´ - 4ì¤„ ë°°ì¹˜ (ì„¸ë¡œ) */
        @media (max-width: 600px) {
            .center-panel {
                padding: 12px 15px;
                gap: 8px;
                width: 55vw;
                max-width: 300px;
                min-width: 250px;
            }
            
            .players-section {
                gap: 6px;
                flex-wrap: wrap;
                flex-direction: column;
                align-items: center;
            }
            
            .player-info {
                min-width: 220px;
                padding: 8px 12px;
                gap: 10px;
                flex: none;
                width: 100%;
                max-width: 250px;
            }
            
            .player-avatar {
                width: 32px;
                height: 32px;
                font-size: 14px;
            }
            
            .player-name {
                font-size: 12px;
            }
            
            .player-score {
                font-size: 11px;
            }
            
            .controls-section {
                gap: 8px;
            }
            
            .game-board {
                width: 90vw;
                height: calc(100% - 4px);
                aspect-ratio: 1.4 / 1;
            }
        }

        @media (max-width: 480px) {
            .center-panel {
                padding: 10px 12px;
                gap: 6px;
                width: 50vw;
                max-width: 280px;
                min-width: 220px;
            }
            
            .players-section {
                gap: 4px;
                flex-wrap: wrap;
                flex-direction: column;
                align-items: center;
            }
            
            .player-info {
                min-width: 200px;
                padding: 6px 10px;
                gap: 8px;
                flex: none;
                width: 100%;
                max-width: 230px;
            }
            
            .player-avatar {
                width: 28px;
                height: 28px;
                font-size: 12px;
            }
            
            .player-name {
                font-size: 11px;
            }
            
            .player-score {
                font-size: 10px;
            }
            
            .player-lands {
                font-size: 9px;
            }
            
            .controls-section {
                gap: 8px;
            }
            
            .player-avatar {
                width: 30px;
                height: 30px;
                font-size: 12px;
            }
            
            .player-name {
                font-size: 12px;
            }
            
            .player-score {
                font-size: 10px;
            }
            
            .golden-keys {
                font-size: 10px;
            }
            
            .controls-section {
                gap: 8px;
            }
            
            .game-board {
                width: 90vw;
                height: calc(100% - 4px);
                aspect-ratio: 1.4 / 1;
            }
            
            .space-number {
                font-size: clamp(6px, 3vw, 14px);
            }
            
            .space-name {
                font-size: clamp(5px, 2.5vw, 10px);
            }
        }

        /* ë³´ë“œ ì¹¸ ìƒ‰ìƒ - CSS ë³€ìˆ˜ ì‚¬ìš© */
        .space-start { background: var(--color-start); color: #fff; }
        .space-quiz { background: var(--color-quiz); color: #fff; }
        .space-golden { background: var(--color-golden); color: #000; }
        .space-special { background: var(--color-special); color: #fff; }
        .space-corner { background: var(--color-corner); color: #fff; }
        .space-finish { background: var(--color-start); color: #fff; }
        .space-jail { background: var(--color-corner); color: #fff; }
        .space-free { background: var(--color-corner); color: #fff; }
        .space-goto { background: var(--color-corner); color: #fff; }
    </style>
</head>
<body>
    <div class="game-container">
        <!-- ê²Œì„ ë³´ë“œ -->
        <div class="board-container">
            <!-- ì „ì²´í™”ë©´ ë²„íŠ¼ -->
            <button class="fullscreen-button" id="fullscreenBtn" onclick="toggleFullscreen()" title="ì „ì²´í™”ë©´ í† ê¸€">
                <div class="fullscreen-icon" id="fullscreenIcon">
                    <!-- í™•ëŒ€ ì•„ì´ì½˜ (ê¸°ë³¸ ìƒíƒœ) - ì„œë¡œ ë©€ì–´ì§€ëŠ” í™”ì‚´í‘œ -->
                    <svg class="expand-icon" viewBox="0 0 20 20" width="20" height="20">
                        <g transform="translate(10, 10) rotate(45)">
                            <!-- ì™¼ìª½ìœ¼ë¡œ í–¥í•˜ëŠ” í™”ì‚´í‘œ (ê¸¸ì´ 2ë°°) -->
                            <path d="M -1 0 L -13 0" stroke="#333" stroke-width="1.5" fill="none"/>
                            <path d="M -9 -4 L -13 0 L -9 4" stroke="#333" stroke-width="1.5" fill="none" stroke-linejoin="round"/>
                            
                            <!-- ì˜¤ë¥¸ìª½ìœ¼ë¡œ í–¥í•˜ëŠ” í™”ì‚´í‘œ (ê¸¸ì´ 2ë°°) -->
                            <path d="M 1 0 L 13 0" stroke="#333" stroke-width="1.5" fill="none"/>
                            <path d="M 9 -4 L 13 0 L 9 4" stroke="#333" stroke-width="1.5" fill="none" stroke-linejoin="round"/>
                        </g>
                    </svg>
                    <!-- ì¶•ì†Œ ì•„ì´ì½˜ (ì „ì²´í™”ë©´ ìƒíƒœ) - ì„œë¡œë¥¼ í–¥í•˜ëŠ” í™”ì‚´í‘œ -->
                    <svg class="minimize-icon" viewBox="0 0 20 20" width="20" height="20">
                        <g transform="translate(10, 10) rotate(45)">
                            <!-- ì˜¤ë¥¸ìª½ì—ì„œ ì™¼ìª½ìœ¼ë¡œ í–¥í•˜ëŠ” í™”ì‚´í‘œ (ê¸¸ì´ 2ë°°) -->
                            <path d="M 13 0 L 1 0" stroke="#333" stroke-width="1.5" fill="none"/>
                            <path d="M 5 -4 L 1 0 L 5 4" stroke="#333" stroke-width="1.5" fill="none" stroke-linejoin="round"/>
                            
                            <!-- ì™¼ìª½ì—ì„œ ì˜¤ë¥¸ìª½ìœ¼ë¡œ í–¥í•˜ëŠ” í™”ì‚´í‘œ (ê¸¸ì´ 2ë°°) -->
                            <path d="M -13 0 L -1 0" stroke="#333" stroke-width="1.5" fill="none"/>
                            <path d="M -5 -4 L -1 0 L -5 4" stroke="#333" stroke-width="1.5" fill="none" stroke-linejoin="round"/>
                        </g>
                    </svg>
            </div>
            </button>

            <!-- ì„¤ì • ë²„íŠ¼ -->
            <button class="settings-button" id="settingsBtn" onclick="openSettings()" title="ê²Œì„ ì„¤ì •">
                <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="3"/>
                    <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1 1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/>
                </svg>
            </button>

            <!-- ì¤‘ì•™ UI íŒ¨ë„ -->
            <div class="center-panel">
            <!-- í”Œë ˆì´ì–´ ì •ë³´ -->
            <div class="players-section">
                <div class="player-info" id="player1-info">
                    <div class="player-avatar" style="background: var(--player-color-1);">1</div>
                    <div class="player-details">
                        <div class="player-name">í”Œë ˆì´ì–´ 1</div>
                        <div class="player-score">ì ìˆ˜: <span id="score1">0</span></div>
                        <div class="player-lands">ë•… ì†Œìœ : <span id="lands1">0</span>ê°œ</div>
                    </div>
                </div>
                
                <div class="player-info" id="player2-info">
                    <div class="player-avatar" style="background: var(--player-color-2);">2</div>
                    <div class="player-details">
                        <div class="player-name">í”Œë ˆì´ì–´ 2</div>
                        <div class="player-score">ì ìˆ˜: <span id="score2">0</span></div>
                        <div class="player-lands">ë•… ì†Œìœ : <span id="lands2">0</span>ê°œ</div>
                        </div>
                    </div>

                    <div class="player-info" id="player3-info">
                        <div class="player-avatar" style="background: var(--player-color-3);">3</div>
                        <div class="player-details">
                            <div class="player-name">í”Œë ˆì´ì–´ 3</div>
                            <div class="player-score">ì ìˆ˜: <span id="score3">0</span></div>
                            <div class="player-lands">ë•… ì†Œìœ : <span id="lands3">0</span>ê°œ</div>
                        </div>
                    </div>

                    <div class="player-info" id="player4-info">
                        <div class="player-avatar" style="background: var(--player-color-4);">4</div>
                        <div class="player-details">
                            <div class="player-name">í”Œë ˆì´ì–´ 4</div>
                            <div class="player-score">ì ìˆ˜: <span id="score4">0</span></div>
                            <div class="player-lands">ë•… ì†Œìœ : <span id="lands4">0</span>ê°œ</div>
                    </div>
                </div>
            </div>
            
            <!-- ê²Œì„ ì»¨íŠ¸ë¡¤ -->
            <div class="controls-section">
                <div class="dice-controls">
                        <div class="dice-display" id="diceDisplay">
                            <svg class="dice-icon" id="diceIcon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <rect width="18" height="18" x="3" y="3" rx="2" ry="2"/>
                                <circle cx="12" cy="12" r="1"/>
                            </svg>
                        </div>
                    <button class="control-button" id="rollDiceBtn" onclick="rollDice()">
                            <span id="buttonText">ì£¼ì‚¬ìœ„ êµ´ë¦¬ê¸°</span>
                    </button>
                </div>
                </div>
            </div>
            
            <div class="game-board" id="gameBoard">
                <!-- ë³´ë“œ ì¹¸ë“¤ì´ JavaScriptë¡œ ë™ì  ìƒì„±ë©ë‹ˆë‹¤ -->
            </div>
        </div>
    </div>

    <!-- í€´ì¦ˆ íŒì—… -->
    <div class="popup-overlay" id="quizPopup">
        <div class="popup-container">
            <h2 class="popup-title">ğŸ§  í€´ì¦ˆ ë„ì „!</h2>
            <div class="popup-content" id="quizContent">
                <p id="quizQuestion">ë¬¸ì œê°€ ë¡œë“œ ì¤‘ì…ë‹ˆë‹¤...</p>
                <div id="quizOptions"></div>
                <div id="quizTimer">â° ë‚¨ì€ ì‹œê°„: <span id="timeLeft">30</span>ì´ˆ</div>
            </div>
        </div>
    </div>

    <!-- í™©ê¸ˆ ì—´ì‡  íŒì—… -->
    <div class="popup-overlay" id="goldenKeyPopup">
        <div class="popup-container">
            <h2 class="popup-title" id="eventTitle">âœ¨ í™©ê¸ˆ ì—´ì‡  ì´ë²¤íŠ¸!</h2>
            <div class="popup-content" id="eventContent">
                <p id="eventDescription">ì´ë²¤íŠ¸ê°€ ë¡œë“œ ì¤‘ì…ë‹ˆë‹¤...</p>
            </div>
            <button class="popup-button" onclick="closeGoldenKey()">í™•ì¸</button>
        </div>
    </div>

    <!-- í„´ ì „í™˜ ì•Œë¦¼ íŒì—… -->
    <div class="popup-overlay" id="turnNotificationPopup">
        <div class="popup-container">
            <h2 class="popup-title">ğŸ® í„´ ì „í™˜</h2>
            <div class="popup-content">
                <p id="turnNotificationText">í”Œë ˆì´ì–´ 2ì˜ ì°¨ë¡€ì…ë‹ˆë‹¤.</p>
            </div>
            <button class="popup-button" onclick="closeTurnNotification()">í™•ì¸</button>
        </div>
    </div>

    <!-- ì„¤ì • ê´€ë¦¬ ìŠ¤í¬ë¦½íŠ¸ -->
    
    <script>
        // ê²Œì„ ìƒíƒœ
        let gameState = {
            players: [
                { id: 1, name: 'í”Œë ˆì´ì–´ 1', color: '#1976D2', position: 0, score: 0, isActive: true },
                { id: 2, name: 'í”Œë ˆì´ì–´ 2', color: '#E65100', position: 0, score: 0, isActive: false },
                { id: 3, name: 'í”Œë ˆì´ì–´ 3', color: '#2E7D32', position: 0, score: 0, isActive: false },
                { id: 4, name: 'í”Œë ˆì´ì–´ 4', color: '#9C27B0', position: 0, score: 0, isActive: false }
            ],
            currentPlayer: 1,
            gamePhase: 'waiting',
            diceValue: 0
        };

        // 7x7 ë³´ë“œ ì¹¸ ë°ì´í„° (ìŠ¤í¬ë¦°ìƒ· ê¸°ì¤€)
        const boardSpaces = [
            // ì‹œì‘ì  (0) - ìš°í•˜ë‹¨
            { id: 0, name: 'ì‹œì‘', type: 'start', color: 'space-start' },
            // í•˜ë‹¨ ë³€ (1-5) - ì˜¤ë¥¸ìª½ì—ì„œ ì™¼ìª½ìœ¼ë¡œ
            { id: 1, name: '1', type: 'quiz', color: 'space-quiz' },
            { id: 2, name: '2', type: 'quiz', color: 'space-quiz' },
            { id: 3, name: 'í™©ê¸ˆì—´ì‡ ', type: 'golden', color: 'space-golden' },
            { id: 4, name: '4', type: 'quiz', color: 'space-quiz' },
            { id: 5, name: '5', type: 'quiz', color: 'space-quiz' },
            // ì¢Œì¸¡ ë³€ (7-11) - ì•„ë˜ì—ì„œ ìœ„ë¡œ
            { id: 7, name: '7', type: 'quiz', color: 'space-quiz' },
            { id: 8, name: '8', type: 'quiz', color: 'space-quiz' },
            { id: 9, name: 'í™©ê¸ˆì—´ì‡ ', type: 'golden', color: 'space-golden' },
            { id: 10, name: '10', type: 'quiz', color: 'space-quiz' },
            { id: 11, name: '11', type: 'quiz', color: 'space-quiz' },
            // ìƒë‹¨ ë³€ (13-17) - ì™¼ìª½ì—ì„œ ì˜¤ë¥¸ìª½ìœ¼ë¡œ
            { id: 13, name: '13', type: 'quiz', color: 'space-quiz' },
            { id: 14, name: '14', type: 'quiz', color: 'space-quiz' },
            { id: 15, name: 'í™©ê¸ˆì—´ì‡ ', type: 'golden', color: 'space-golden' },
            { id: 16, name: '16', type: 'quiz', color: 'space-quiz' },
            { id: 17, name: '17', type: 'quiz', color: 'space-quiz' },
            // ìš°ì¸¡ ë³€ (19-23) - ìœ„ì—ì„œ ì•„ë˜ë¡œ
            { id: 19, name: '19', type: 'quiz', color: 'space-quiz' },
            { id: 20, name: '20', type: 'quiz', color: 'space-quiz' },
            { id: 21, name: 'í™©ê¸ˆì—´ì‡ ', type: 'golden', color: 'space-golden' },
            { id: 22, name: '22', type: 'quiz', color: 'space-quiz' },
            { id: 23, name: '23', type: 'quiz', color: 'space-quiz' },
            // íŠ¹ë³„ ì¹¸ë“¤ (ëª¨ì„œë¦¬) - BoardColorTest.htmlê³¼ ë™ì¼í•˜ê²Œ corner íƒ€ì…ìœ¼ë¡œ ë³€ê²½
            { id: 6, name: 'ë¬´ë£Œì£¼ì°¨', type: 'corner', color: 'space-corner' },
            { id: 12, name: 'ì¶œë°œì§€ë¡œ', type: 'corner', color: 'space-corner' },
            { id: 18, name: 'ê°ì˜¥', type: 'corner', color: 'space-corner' },
            { id: 24, name: 'íŠ¹ë³„ì¹¸', type: 'special', color: 'space-special' }
        ];

        // í€´ì¦ˆ ë°ì´í„°
        const quizQuestions = [
            {
                question: "1 + 1ì€?",
                options: ["1", "2", "3", "4"],
                correct: 1,
                points: 100
            },
            {
                question: "íƒœì–‘ê³„ì—ì„œ ê°€ì¥ í° í–‰ì„±ì€?",
                options: ["ì§€êµ¬", "ëª©ì„±", "í† ì„±", "í™”ì„±"],
                correct: 1,
                points: 200
            },
            {
                question: "í•œêµ­ì˜ ìˆ˜ë„ëŠ”?",
                options: ["ë¶€ì‚°", "ì„œìš¸", "ëŒ€êµ¬", "ì¸ì²œ"],
                correct: 1,
                points: 100
            },
            {
                question: "2 Ã— 3ì€?",
                options: ["5", "6", "7", "8"],
                correct: 1,
                points: 150
            },
            {
                question: "ì§€êµ¬ì—ì„œ ê°€ì¥ í° ëŒ€ë¥™ì€?",
                options: ["ì•„ì‹œì•„", "ì•„í”„ë¦¬ì¹´", "ìœ ëŸ½", "ë¶ì•„ë©”ë¦¬ì¹´"],
                correct: 0,
                points: 200
            }
        ];

        // í™©ê¸ˆ ì—´ì‡  ì´ë²¤íŠ¸
        const goldenKeyEvents = [
            {
                name: "ğŸš€ ë¡œì¼“ ë¶€ìŠ¤í„°",
                description: "ì¦‰ì‹œ ì¶œë°œì§€ë¡œ ì›Œí”„ ì´ë™! í†µê³¼ ë³´ë„ˆìŠ¤ 400ì  íšë“!",
                effect: () => {
                    const player = gameState.players.find(p => p.id === gameState.currentPlayer);
                    player.position = 0;
                    player.score += 400;
                    updateUI();
                }
            },
            {
                name: "ğŸ’° ë³µê¶Œ ë‹¹ì²¨",
                description: "ì¶•í•˜í•©ë‹ˆë‹¤! 500ì ì„ íšë“í–ˆìŠµë‹ˆë‹¤!",
                effect: () => {
                    const player = gameState.players.find(p => p.id === gameState.currentPlayer);
                    player.score += 500;
                    updateUI();
                }
            },
            {
                name: "ğŸª ì„œì»¤ìŠ¤ë‹¨ ì´ˆëŒ€",
                description: "ëª¨ë“  í”Œë ˆì´ì–´ê°€ 3ì¹¸ì”© ì´ë™í•˜ê³  100ì ì”© íšë“í•©ë‹ˆë‹¤!",
                effect: () => {
                    gameState.players.forEach(player => {
                        let newPosition = player.position + 3;
                        // ë³´ë“œë¥¼ í•œ ë°”í€´ ëŒë©´ ì‹œì‘ì  í†µê³¼ ë³´ë„ˆìŠ¤
                        if (newPosition >= 24) {
                            newPosition = newPosition - 24;
                            player.score += 200; // ì‹œì‘ì  í†µê³¼ ë³´ë„ˆìŠ¤
                        }
                        player.position = newPosition;
                        player.score += 100;
                    });
                    updatePlayerPieces();
                    updateUI();
                }
            },
            {
                name: "ğŸŒªï¸ í† ë„¤ì´ë„ ìŠµê²©",
                description: "ëª¨ë“  í”Œë ˆì´ì–´ê°€ ëœë¤ ìœ„ì¹˜ë¡œ í©ì–´ì§€ê³  50ì ì”© ì°¨ê°ë©ë‹ˆë‹¤!",
                effect: () => {
                    gameState.players.forEach(player => {
                        player.position = Math.floor(Math.random() * 24);
                        player.score = Math.max(0, player.score - 50);
                    });
                    updatePlayerPieces();
                    updateUI();
                }
            },
            {
                name: "ğŸ ì‹ ë¹„í•œ ìƒì",
                description: "ìƒìë¥¼ ì—´ì–´ë³´ì„¸ìš”! 500ì , 0ì , ë˜ëŠ” -200ì  ì¤‘ í•˜ë‚˜ë¥¼ íšë“í•©ë‹ˆë‹¤!",
                effect: () => {
                    const player = gameState.players.find(p => p.id === gameState.currentPlayer);
                    const results = [
                        { points: 500, message: "ğŸ‰ ëŒ€ë°•! í™©ê¸ˆ ë³´ë¬¼ì„ ë°œê²¬í–ˆìŠµë‹ˆë‹¤! +500ì !" },
                        { points: 0, message: "ğŸ˜… ë¹ˆ ìƒìì˜€ìŠµë‹ˆë‹¤... ì•„ë¬´ê²ƒë„ ì–»ì§€ ëª»í–ˆìŠµë‹ˆë‹¤." },
                        { points: -200, message: "ğŸ’¥ í•¨ì •ì´ì—ˆìŠµë‹ˆë‹¤! ìƒìì—ì„œ ë…ê°€ìŠ¤ê°€ ë‚˜ì™€ -200ì !" }
                    ];
                    const randomResult = results[Math.floor(Math.random() * results.length)];
                    
                    // ì ìˆ˜ ì ìš©
                    const oldScore = player.score;
                    player.score = Math.max(0, player.score + randomResult.points);
                    const actualChange = player.score - oldScore;
                    
                    // ê²°ê³¼ ë©”ì‹œì§€ í‘œì‹œ
                    let resultMessage = randomResult.message;
                    if (randomResult.points < 0 && actualChange > randomResult.points) {
                        resultMessage += ` (ì‹¤ì œ ë³€í™”: ${actualChange}ì )`;
                    }
                    
                    setTimeout(() => {
                        showMessage(resultMessage);
                        // ê²°ê³¼ ë©”ì‹œì§€ í‘œì‹œ í›„ í„´ ì „í™˜
                        setTimeout(() => {
                            endTurn();
                        }, 2000);
                    }, 500);
                    
                    updateUI();
                }
            }
        ];

        // ê²Œì„ ì´ˆê¸°í™”
        function initGame() {
            // ê¸°ë³¸ íŒ”ë ˆíŠ¸(ì˜¤ì…˜ í†¤) ì ìš©
            const defaultPalette = palettesData.palettes[0]; // ì˜¤ì…˜ í†¤
            
            // CSS ë³€ìˆ˜ ì—…ë°ì´íŠ¸
            document.documentElement.style.setProperty('--color-start', defaultPalette.colors.golden);
            document.documentElement.style.setProperty('--color-quiz', defaultPalette.colors.quiz);
            document.documentElement.style.setProperty('--color-golden', defaultPalette.colors.golden);
            document.documentElement.style.setProperty('--color-special', defaultPalette.colors.special);
            document.documentElement.style.setProperty('--color-corner', defaultPalette.colors.corner);
            document.documentElement.style.setProperty('--color-center', defaultPalette.colors.center);
            document.documentElement.style.setProperty('--color-background', defaultPalette.colors.background);
            document.documentElement.style.setProperty('--color-normal', defaultPalette.colors.normal);
            
            // íŒ”ë ˆíŠ¸ë³„ í”Œë ˆì´ì–´ ìƒ‰ìƒ CSS ë³€ìˆ˜ ì„¤ì •
            defaultPalette.playerColors.forEach((color, index) => {
                document.documentElement.style.setProperty(`--player-color-${index + 1}`, color);
            });
            
            // í”Œë ˆì´ì–´ ìƒ‰ìƒ ì—…ë°ì´íŠ¸
            defaultPalette.playerColors.forEach((color, index) => {
                if (gameState.players[index]) {
                    gameState.players[index].color = color;
                }
            });
            
            // ë³´ë“œ ìƒì„±
            createBoard();
            
            // ì´ˆê¸° ì£¼ì‚¬ìœ„ ê°’ ì„¤ì • (1ë¡œ ì‹œì‘)
            gameState.diceValue = 1;
            updateDiceIcon(1);
            updateUI();
            
            // ì†Œìœ ê¶Œ ì´ˆê¸°í™” ë° ë ì§€ ìƒ‰ìƒ ì„¤ì •
            resetSpaceOwners();
            // ë³´ë“œ ìƒì„± í›„ ë ì§€ ìƒ‰ìƒ ì´ˆê¸°í™”
            setTimeout(() => {
                updateRibbonColors();
                updateLandOwnershipDisplay(); // ë•… ì†Œìœ  í‘œì‹œ ì´ˆê¸°í™”
            }, 100);
        }

        // ëª¨ë…¸í´ë¦¬ ìŠ¤íƒ€ì¼ ë³´ë“œ ìƒì„±
        function createBoard() {
            const board = document.getElementById('gameBoard');
            board.innerHTML = '';

            // 7x7 ê·¸ë¦¬ë“œ ìƒì„±
            for (let row = 0; row < 7; row++) {
                for (let col = 0; col < 7; col++) {
                    const cell = document.createElement('div');
                    cell.className = 'board-space';
                    
                    // ëª¨ì„œë¦¬ ì¹¸ë“¤
                    if ((row === 0 && col === 0) || (row === 0 && col === 6) || 
                        (row === 6 && col === 0) || (row === 6 && col === 6)) {
                        cell.classList.add('corner-space');
                        
                        if (row === 0 && col === 0) {
                            // ì¶œë°œì§€ë¡œ - special íƒ€ì…
                            const space = boardSpaces.find(s => s.id === 12);
                            if (space) {
                                cell.className = `board-space corner-space ${space.color}`;
                            }
                            cell.innerHTML = '<div class="space-name">ì¶œë°œì§€ë¡œ</div>';
                            cell.onclick = () => handleSpaceClick(12);
                        } else if (row === 0 && col === 6) {
                            // ê°ì˜¥ - special íƒ€ì…
                            const space = boardSpaces.find(s => s.id === 18);
                            if (space) {
                                cell.className = `board-space corner-space ${space.color}`;
                            }
                            cell.innerHTML = '<div class="space-name">ê°ì˜¥</div>';
                            cell.onclick = () => handleSpaceClick(18);
                        } else if (row === 6 && col === 0) {
                            // ë¬´ë£Œì£¼ì°¨ - special íƒ€ì…
                            const space = boardSpaces.find(s => s.id === 6);
                            if (space) {
                                cell.className = `board-space corner-space ${space.color}`;
                            }
                            cell.innerHTML = '<div class="space-name">ë¬´ë£Œì£¼ì°¨</div>';
                            cell.onclick = () => handleSpaceClick(6);
                        } else if (row === 6 && col === 6) {
                            // ì‹œì‘ - start íƒ€ì…
                            const space = boardSpaces.find(s => s.id === 0);
                            if (space) {
                                cell.className = `board-space corner-space ${space.color}`;
                            }
                            cell.innerHTML = '<div class="space-name">ì‹œì‘</div>';
                            cell.onclick = () => handleSpaceClick(0);
                        }
                        
                        // ì¤‘ì•™ íŒ¨ë„ê³¼ ê²¹ì¹˜ëŠ” ëª¨ì„œë¦¬ ì¹¸ë“¤ì€ í˜¸ë²„ íš¨ê³¼ ë¹„í™œì„±í™”
                        if ((row >= 2 && row <= 4) && (col >= 2 && col <= 4)) {
                            cell.className += ' center-background';
                        }
                    }
                    // ë‚´ë¶€ 5x5 ê·¸ë¦¬ë“œ (ë¹ˆì¹¸ë“¤)
                    else if (row >= 1 && row <= 5 && col >= 1 && col <= 5) {
                        // ë¹ˆì¹¸ë“¤ (í€´ì¦ˆ, ë§ˆë¸” ê¸€ì”¨ ì œê±°)
                        cell.style.background = 'var(--color-center)';
                        cell.style.border = 'none';
                        cell.style.boxShadow = 'none';
                        cell.style.outline = 'none';
                        cell.innerHTML = '';
                        cell.className = 'board-space center-background'; // í˜¸ë²„ íš¨ê³¼ ë¹„í™œì„±í™”
                        // í´ë¦­ ì´ë²¤íŠ¸ ì œê±° (onclick ì„¤ì •í•˜ì§€ ì•ŠìŒ)
                    }
                    // ê²½ê³„ ì¹¸ë“¤ (ì™¸ê³½ ê²½ë¡œ)
                    else {
                        const spaceIndex = getSpaceIndex(row, col);
                        if (spaceIndex !== -1) {
                            const space = boardSpaces.find(s => s.id === spaceIndex);
                            if (space) {
                                cell.className = `board-space ${space.color}`;
                                cell.dataset.space = spaceIndex; // ë ì§€ ì‹œìŠ¤í…œì„ ìœ„í•œ data-space ì†ì„± ì¶”ê°€
                                cell.innerHTML = `
                                    <div class="space-number">${space.id}</div>
                                    <div class="space-name">${space.name}</div>
                                `;
                                
                                // ì¤‘ì•™ íŒ¨ë„ê³¼ ê²¹ì¹˜ëŠ” ì˜ì—­ì˜ ì¹¸ë“¤ì€ í´ë¦­ ì´ë²¤íŠ¸ ì œê±°
                                if ((row >= 2 && row <= 4) && (col >= 2 && col <= 4)) {
                                    cell.className += ' center-background';
                                    // í´ë¦­ ì´ë²¤íŠ¸ ì œê±° (onclick ì„¤ì •í•˜ì§€ ì•ŠìŒ)
                                } else {
                                    cell.onclick = () => handleSpaceClick(space.id);
                                }
                            }
                        } else {
                            cell.style.background = 'transparent';
                            cell.style.border = 'none';
                            // ì¤‘ì•™ íŒ¨ë„ê³¼ ê²¹ì¹˜ëŠ” ì˜ì—­ì˜ ë¹ˆ ì¹¸ë“¤ë„ í˜¸ë²„ íš¨ê³¼ ë¹„í™œì„±í™”
                            if ((row >= 2 && row <= 4) && (col >= 2 && col <= 4)) {
                                cell.className = 'board-space center-background';
                            }
                        }
                    }
                    
                    board.appendChild(cell);
                }
            }

            // í”Œë ˆì´ì–´ ë§ë“¤ ë°°ì¹˜
            updatePlayerPieces();
        }

        // ê·¸ë¦¬ë“œ ìœ„ì¹˜ë¥¼ ë³´ë“œ ì¹¸ ì¸ë±ìŠ¤ë¡œ ë³€í™˜ (ìŠ¤í¬ë¦°ìƒ· ê¸°ì¤€)
        function getSpaceIndex(row, col) {
            // ìƒë‹¨ ë³€ (13-17) - ì™¼ìª½ì—ì„œ ì˜¤ë¥¸ìª½ìœ¼ë¡œ
            if (row === 0 && col >= 1 && col <= 5) {
                return 12 + col; // 13, 14, 15, 16, 17
            }
            // ìš°ì¸¡ ë³€ (19-23) - ìœ„ì—ì„œ ì•„ë˜ë¡œ
            else if (col === 6 && row >= 1 && row <= 5) {
                return 18 + row; // 19, 20, 21, 22, 23
            }
            // í•˜ë‹¨ ë³€ (1-5) - ì˜¤ë¥¸ìª½ì—ì„œ ì™¼ìª½ìœ¼ë¡œ
            else if (row === 6 && col >= 1 && col <= 5) {
                return 6 - col; // 5, 4, 3, 2, 1
            }
            // ì¢Œì¸¡ ë³€ (7-11) - ì•„ë˜ì—ì„œ ìœ„ë¡œ
            else if (col === 0 && row >= 1 && row <= 5) {
                return 12 - row; // 11, 10, 9, 8, 7
            }
            return -1;
        }

        // í”Œë ˆì´ì–´ ë§ë“¤ ì—…ë°ì´íŠ¸
        function updatePlayerPieces() {
            // ê¸°ì¡´ ë§ë“¤ ì œê±°
            document.querySelectorAll('.player-piece').forEach(piece => piece.remove());

            // ê° ì¹¸ë³„ë¡œ í”Œë ˆì´ì–´ë“¤ì„ ê·¸ë£¹í™”
            const playersByPosition = {};
            gameState.players.forEach(player => {
                if (player.position >= 0 && player.position < boardSpaces.length) {
                    if (!playersByPosition[player.position]) {
                        playersByPosition[player.position] = [];
                    }
                    playersByPosition[player.position].push(player);
                }
            });

            // ê° ì¹¸ì— í”Œë ˆì´ì–´ ë§ë“¤ ë°°ì¹˜
            Object.keys(playersByPosition).forEach(position => {
                const players = playersByPosition[position];
                const gridPos = getGridPosition(parseInt(position));
                
                if (gridPos) {
                    const cellIndex = gridPos.row * 7 + gridPos.col;
                        const spaceElement = document.querySelectorAll('.board-space')[cellIndex];
                    
                        if (spaceElement) {
                        players.forEach((player, index) => {
                            const piece = document.createElement('div');
                            piece.className = 'player-piece';
                            piece.style.background = player.color;
                            piece.textContent = player.id;
                            
                            // ìƒë‹¨ ìš°ì¸¡ ì •ë ¬ ë°°ì¹˜ ê³„ì‚°
                            const totalPlayers = players.length;
                            let rightPosition;
                            
                            if (totalPlayers === 1) {
                                rightPosition = '5%';
                            } else if (totalPlayers === 2) {
                                rightPosition = index === 0 ? '30%' : '5%';
                            } else if (totalPlayers === 3) {
                                rightPosition = index === 0 ? '55%' : index === 1 ? '30%' : '5%';
                            } else { // 4ëª…
                                rightPosition = index === 0 ? '80%' : index === 1 ? '55%' : index === 2 ? '30%' : '5%';
                            }
                            
                            piece.style.right = rightPosition;
                            piece.style.left = 'auto'; // left ì†ì„± ì´ˆê¸°í™”
                            spaceElement.appendChild(piece);
                        });
                    }
                }
            });
        }

        // ë³´ë“œ ì¹¸ ì¸ë±ìŠ¤ë¥¼ ê·¸ë¦¬ë“œ ìœ„ì¹˜ë¡œ ë³€í™˜ (ìŠ¤í¬ë¦°ìƒ· ê¸°ì¤€)
        function getGridPosition(spaceIndex) {
            if (spaceIndex === 0) return { row: 6, col: 6 }; // ì‹œì‘ (ìš°í•˜ë‹¨)
            if (spaceIndex === 6) return { row: 6, col: 0 }; // ë¬´ë£Œì£¼ì°¨ (ì¢Œí•˜ë‹¨)
            if (spaceIndex === 12) return { row: 0, col: 0 }; // ì¶œë°œì§€ë¡œ (ì¢Œìƒë‹¨)
            if (spaceIndex === 18) return { row: 0, col: 6 }; // ê°ì˜¥ (ìš°ìƒë‹¨)
            
            // ìƒë‹¨ ë³€ (13-17) - ì™¼ìª½ì—ì„œ ì˜¤ë¥¸ìª½ìœ¼ë¡œ
            if (spaceIndex >= 13 && spaceIndex <= 17) {
                return { row: 0, col: spaceIndex - 12 };
            }
            // ìš°ì¸¡ ë³€ (19-23) - ìœ„ì—ì„œ ì•„ë˜ë¡œ
            else if (spaceIndex >= 19 && spaceIndex <= 23) {
                return { row: spaceIndex - 18, col: 6 };
            }
            // í•˜ë‹¨ ë³€ (1-5) - ì˜¤ë¥¸ìª½ì—ì„œ ì™¼ìª½ìœ¼ë¡œ
            else if (spaceIndex >= 1 && spaceIndex <= 5) {
                return { row: 6, col: 6 - spaceIndex };
            }
            // ì¢Œì¸¡ ë³€ (7-11) - ì•„ë˜ì—ì„œ ìœ„ë¡œ
            else if (spaceIndex >= 7 && spaceIndex <= 11) {
                return { row: 12 - spaceIndex, col: 0 };
            }
            
            return null;
        }

        // ìƒˆë¡œìš´ SVG ê¸°ë°˜ ì£¼ì‚¬ìœ„ ì‹œìŠ¤í…œ
        let isRolling = false;
        
        // í€´ì¦ˆ íƒ€ì´ë¨¸ ë³€ìˆ˜
        let quizTimer = null;

        // ì†Œìœ ê¶Œ ì‹œìŠ¤í…œ
        let spaceOwners = {
            1: null, 2: null, 4: null, 5: null,      // 1ë²ˆ ì§€ì—­
            7: null, 8: null, 10: null, 11: null,    // 2ë²ˆ ì§€ì—­
            13: null, 14: null, 16: null, 17: null,  // 3ë²ˆ ì§€ì—­
            19: null, 20: null, 22: null, 23: null   // 4ë²ˆ ì§€ì—­
        };


        // ë ì§€ ìƒ‰ìƒ ì—…ë°ì´íŠ¸ í•¨ìˆ˜ (ë™ì  í”Œë ˆì´ì–´ ìƒ‰ìƒ ì‚¬ìš©)
        function updateRibbonColors() {
            const spaces = document.querySelectorAll('.board-space[data-space]');
            if (spaces.length === 0) {
                return;
            }
            
            spaces.forEach(space => {
                const spaceNumber = parseInt(space.dataset.space);
                const ownerIndex = spaceOwners[spaceNumber];
                
                if (ownerIndex !== null && ownerIndex !== undefined) {
                    // í˜„ì¬ ê²Œì„ ìƒíƒœì˜ í”Œë ˆì´ì–´ ìƒ‰ìƒ ì‚¬ìš© (íŒ”ë ˆíŠ¸ ë³€ê²½ ì‹œ ë™ì ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë¨)
                    const ownerColor = gameState.players[ownerIndex] ? gameState.players[ownerIndex].color : '#1976D2';
                    space.style.setProperty('--ribbon-color', ownerColor);
                    
                } else {
                    // ì†Œìœ ìê°€ ì—†ìœ¼ë©´ íˆ¬ëª…í•˜ê²Œ
                    space.style.setProperty('--ribbon-color', 'transparent');
                }
            });
        }

        // ì†Œìœ ê¶Œ ì´ˆê¸°í™” í•¨ìˆ˜
        function resetSpaceOwners() {
            spaceOwners = {
                1: null, 2: null, 4: null, 5: null,      // 1ë²ˆ ì§€ì—­
                7: null, 8: null, 10: null, 11: null,    // 2ë²ˆ ì§€ì—­
                13: null, 14: null, 16: null, 17: null,  // 3ë²ˆ ì§€ì—­
                19: null, 20: null, 22: null, 23: null   // 4ë²ˆ ì§€ì—­
            };
        }

        // ì¹¸ êµ¬ë§¤ í•¨ìˆ˜ (ë¬¸ì œë¥¼ ë§ì·„ì„ ë•Œ í˜¸ì¶œ)
        function buySpace(playerIndex, spaceNumber) {
            if (spaceOwners[spaceNumber] === null) {
                spaceOwners[spaceNumber] = playerIndex;
                updateRibbonColors();
                updateLandOwnershipDisplay(); // ë•… ì†Œìœ  í‘œì‹œ ì—…ë°ì´íŠ¸
            }
        }

        // ë•… ì†Œìœ  ê°œìˆ˜ ê³„ì‚° í•¨ìˆ˜
        function getPlayerLandCount(playerIndex) {
            let count = 0;
            for (const spaceNumber in spaceOwners) {
                if (spaceOwners[spaceNumber] === playerIndex) {
                    count++;
                }
            }
            return count;
        }

        // ë•… ì†Œìœ  í‘œì‹œ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function updateLandOwnershipDisplay() {
            for (let i = 0; i < 4; i++) {
                const landCount = getPlayerLandCount(i);
                const landElement = document.getElementById(`lands${i + 1}`);
                if (landElement) {
                    landElement.textContent = landCount;
                }
            }
        }

        // ì£¼ì‚¬ìœ„ ì•„ì´ì½˜ SVG íŒ¨í„´ë“¤ (í°ìƒ‰ ë°°ê²½)
        const dicePatterns = {
            1: `<rect width="18" height="18" x="3" y="3" rx="2" ry="2" fill="white" stroke="#374151" stroke-width="1"/>
                <circle cx="12" cy="12" r="1" fill="#374151"/>`,
            
            2: `<rect width="18" height="18" x="3" y="3" rx="2" ry="2" fill="white" stroke="#374151" stroke-width="1"/>
                <circle cx="8" cy="8" r="1" fill="#374151"/>
                <circle cx="16" cy="16" r="1" fill="#374151"/>`,
            
            3: `<rect width="18" height="18" x="3" y="3" rx="2" ry="2" fill="white" stroke="#374151" stroke-width="1"/>
                <circle cx="8" cy="8" r="1" fill="#374151"/>
                <circle cx="12" cy="12" r="1" fill="#374151"/>
                <circle cx="16" cy="16" r="1" fill="#374151"/>`,
            
            4: `<rect width="18" height="18" x="3" y="3" rx="2" ry="2" fill="white" stroke="#374151" stroke-width="1"/>
                <circle cx="8" cy="8" r="1" fill="#374151"/>
                <circle cx="8" cy="16" r="1" fill="#374151"/>
                <circle cx="16" cy="8" r="1" fill="#374151"/>
                <circle cx="16" cy="16" r="1" fill="#374151"/>`,
            
            5: `<rect width="18" height="18" x="3" y="3" rx="2" ry="2" fill="white" stroke="#374151" stroke-width="1"/>
                <circle cx="8" cy="8" r="1" fill="#374151"/>
                <circle cx="8" cy="16" r="1" fill="#374151"/>
                <circle cx="12" cy="12" r="1" fill="#374151"/>
                <circle cx="16" cy="8" r="1" fill="#374151"/>
                <circle cx="16" cy="16" r="1" fill="#374151"/>`,
            
            6: `<rect width="18" height="18" x="3" y="3" rx="2" ry="2" fill="white" stroke="#374151" stroke-width="1"/>
                <circle cx="8" cy="8" r="1" fill="#374151"/>
                <circle cx="8" cy="12" r="1" fill="#374151"/>
                <circle cx="8" cy="16" r="1" fill="#374151"/>
                <circle cx="16" cy="8" r="1" fill="#374151"/>
                <circle cx="16" cy="12" r="1" fill="#374151"/>
                <circle cx="16" cy="16" r="1" fill="#374151"/>`
        };

        // ì£¼ì‚¬ìœ„ ì•„ì´ì½˜ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function updateDiceIcon(value) {
            const diceIcon = document.getElementById('diceIcon');
            diceIcon.innerHTML = dicePatterns[value];
        }

        // ì£¼ì‚¬ìœ„ êµ´ë¦¬ê¸°
        function rollDice() {
            if (gameState.gamePhase !== 'waiting' && gameState.gamePhase !== 'rolling') return;
            if (isRolling) return;

            const diceIcon = document.getElementById('diceIcon');
            const rollBtn = document.getElementById('rollDiceBtn');
            
            isRolling = true;
            gameState.gamePhase = 'rolling';
            
            // ì• ë‹ˆë©”ì´ì…˜ ì‹œì‘
            diceIcon.classList.add('spinning');
            rollBtn.disabled = true;
            // ë²„íŠ¼ í…ìŠ¤íŠ¸ëŠ” ê·¸ëŒ€ë¡œ ìœ ì§€ (í¬ê¸° ë³€í™” ë°©ì§€)

            const finalValue = Math.floor(Math.random() * 6) + 1;
            
            // ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼ë¥¼ ìœ„í•œ ì—¬ëŸ¬ ë²ˆ ê°’ ë³€ê²½
            let rolls = 0;
            const rollInterval = setInterval(() => {
                const tempValue = Math.floor(Math.random() * 6) + 1;
                updateDiceIcon(tempValue);
                rolls++;
                
                // 10ë²ˆ êµ´ë¦° í›„ ìµœì¢… ê°’ìœ¼ë¡œ ì„¤ì •
                if (rolls > 10) {
                    clearInterval(rollInterval);
                    gameState.diceValue = finalValue;
                    gameState.gamePhase = 'moving';
                    updateDiceIcon(finalValue);
                    
                    diceIcon.classList.remove('spinning');
                rollBtn.disabled = false;
                    isRolling = false;

                // í”Œë ˆì´ì–´ ì´ë™
                setTimeout(() => {
                        movePlayer(finalValue);
                    }, 300);
                }
            }, 100); // 100msë§ˆë‹¤ ì£¼ì‚¬ìœ„ ê°’ ë³€ê²½
        }

        // í”Œë ˆì´ì–´ ì´ë™
        function movePlayer(steps) {
            const player = gameState.players.find(p => p.id === gameState.currentPlayer);
            const startPosition = player.position;
            let currentStep = 0;
            
            // ë‹¨ê³„ë³„ ì´ë™ ì• ë‹ˆë©”ì´ì…˜
            const moveStep = () => {
                if (currentStep < steps) {
                    currentStep++;
                    let tempPosition = startPosition + currentStep;
            
            // ë³´ë“œë¥¼ í•œ ë°”í€´ ëŒë©´ ì‹œì‘ì  í†µê³¼ ë³´ë„ˆìŠ¤ (24ì¹¸ ë³´ë“œ)
                    if (tempPosition >= 24) {
                        tempPosition = tempPosition - 24;
                        if (currentStep === steps) { // ë§ˆì§€ë§‰ ë‹¨ê³„ì—ì„œë§Œ ë³´ë„ˆìŠ¤ ì ìš©
                player.score += 200;
                showMessage('ì‹œì‘ì  í†µê³¼ ë³´ë„ˆìŠ¤! +200ì ');
                        }
            }
            
                    // ì„ì‹œ ìœ„ì¹˜ë¡œ í”Œë ˆì´ì–´ ì´ë™ (ì• ë‹ˆë©”ì´ì…˜ìš©)
                    player.position = tempPosition;
            updatePlayerPieces();
                    
                    // ì´ë™ ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼
                    const playerPiece = document.querySelector(`.player-piece[style*="background: ${player.color}"]`);
                    if (playerPiece) {
                        playerPiece.classList.add('moving');
                        setTimeout(() => {
                            playerPiece.classList.remove('moving');
                        }, 600);
                    }
                    
                    // ë‹¤ìŒ ë‹¨ê³„ë¡œ ì´ë™ (0.4ì´ˆ ê°„ê²©)
                    setTimeout(moveStep, 400);
                } else {
                    // ìµœì¢… ìœ„ì¹˜ ì„¤ì • ë° ì°©ì§€ ì• ë‹ˆë©”ì´ì…˜
                    let finalPosition = startPosition + steps;
                    if (finalPosition >= 24) {
                        finalPosition = finalPosition - 24;
                    }
                    player.position = finalPosition;
                    
                    // ì°©ì§€ ì• ë‹ˆë©”ì´ì…˜
                    const playerPiece = document.querySelector(`.player-piece[style*="background: ${player.color}"]`);
                    if (playerPiece) {
                        playerPiece.classList.add('landing');
                        setTimeout(() => {
                            playerPiece.classList.remove('landing');
                        }, 400);
                    }
                    
            updateUI();

            // ë„ì°©í•œ ì¹¸ì˜ ì•¡ì…˜ ì²˜ë¦¬
            setTimeout(() => {
                        handleSpaceAction(finalPosition);
            }, 500);
                }
            };
            
            // ì²« ë²ˆì§¸ ë‹¨ê³„ ì‹œì‘
            moveStep();
        }

        // ì¹¸ ì•¡ì…˜ ì²˜ë¦¬
        function handleSpaceAction(position) {
            const space = boardSpaces.find(s => s.id === position);
            if (!space) return;

            switch (space.type) {
                case 'start':
                    // ì‹œì‘ì ì€ ì´ë¯¸ í†µê³¼ ë³´ë„ˆìŠ¤ë¡œ ì²˜ë¦¬ë¨
                    break;
                case 'quiz':
                    showQuiz();
                    return;
                case 'golden':
                    showGoldenKeyEvent();
                    return;
                case 'corner':
                    // corner íƒ€ì… ì¹¸ë“¤ì˜ ì´ë¦„ì— ë”°ë¼ ë‹¤ë¥¸ ì•¡ì…˜ ìˆ˜í–‰
                    if (space.name === 'ê°ì˜¥') {
                        const jailPlayer = gameState.players.find(p => p.id === gameState.currentPlayer);
                        jailPlayer.position = 18; // ê°ì˜¥ì— ë¨¸ë¬¼ê¸° (ì‹¤ì œ ê°ì˜¥ ìœ„ì¹˜)
                        showMessage('ê°ì˜¥ì— ê°‡í˜”ìŠµë‹ˆë‹¤! ë‹¤ìŒ í„´ì— ì£¼ì‚¬ìœ„ë¥¼ êµ´ë ¤ì„œ íƒˆì¶œí•˜ì„¸ìš”.');
                    } else if (space.name === 'ë¬´ë£Œì£¼ì°¨') {
                        showMessage('ë¬´ë£Œ ì£¼ì°¨! íŠ¹ë³„í•œ ì¼ì´ ì—†ìŠµë‹ˆë‹¤.');
                    } else if (space.name === 'ì¶œë°œì§€ë¡œ') {
                        const gotoPlayer = gameState.players.find(p => p.id === gameState.currentPlayer);
                        gotoPlayer.position = 0; // ì‹œì‘ì ìœ¼ë¡œ ì´ë™
                        gotoPlayer.score += 200;
                        showMessage('ì¶œë°œì§€ë¡œ ì´ë™! +200ì ');
                    } else {
                        // ê¸°íƒ€ ëª¨ì„œë¦¬ ì¹¸ì€ í™©ê¸ˆì—´ì‡  ì´ë²¤íŠ¸ë¡œ ì²˜ë¦¬
                        showGoldenKeyEvent();
                    }
                    break;
                case 'special':
                    // special íƒ€ì… ì¹¸ë“¤ì€ í™©ê¸ˆì—´ì‡  ì´ë²¤íŠ¸ë¡œ ì²˜ë¦¬
                    showGoldenKeyEvent();
                    return;
                case 'finish':
                    const finishPlayer = gameState.players.find(p => p.id === gameState.currentPlayer);
                    finishPlayer.score += 500;
                    showMessage('ë„ì°©ì  ë„ë‹¬! +500ì ');
                    break;
            }

            // ìë™ìœ¼ë¡œ í„´ ì „í™˜ (í„´ ì¢…ë£Œ ë²„íŠ¼ ì œê±°)
            setTimeout(() => {
                endTurn();
            }, 2000); // 2ì´ˆ í›„ ìë™ í„´ ì „í™˜
            updateUI();
        }

        // í€´ì¦ˆ í‘œì‹œ
        function showQuiz() {
            try {
            const question = quizQuestions[Math.floor(Math.random() * quizQuestions.length)];
            const popup = document.getElementById('quizPopup');
            const questionEl = document.getElementById('quizQuestion');
            const optionsEl = document.getElementById('quizOptions');

                if (!popup || !questionEl || !optionsEl) {
                    return;
                }

            questionEl.textContent = question.question;
            optionsEl.innerHTML = '';

            question.options.forEach((option, index) => {
                const button = document.createElement('button');
                button.className = 'popup-button';
                button.textContent = `${String.fromCharCode(65 + index)}. ${option}`;
                button.onclick = () => answerQuiz(index, question.correct, question.points);
                optionsEl.appendChild(button);
            });

            popup.classList.add('show');
            startQuizTimer();
            } catch (error) {
                showMessage('í€´ì¦ˆë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
            }
        }

        // í€´ì¦ˆ íƒ€ì´ë¨¸
        function startQuizTimer() {
            // ê¸°ì¡´ íƒ€ì´ë¨¸ê°€ ìˆë‹¤ë©´ ì •ë¦¬
            if (quizTimer) {
                clearInterval(quizTimer);
                quizTimer = null;
            }
            
            let timeLeft = 30;
            const timerEl = document.getElementById('timeLeft');
            
            // ì´ˆê¸° ì‹œê°„ í‘œì‹œ
            if (timerEl) {
                timerEl.textContent = timeLeft;
            }
            
            quizTimer = setInterval(() => {
                timeLeft--;
                if (timerEl) {
                timerEl.textContent = timeLeft;
                }
                
                if (timeLeft <= 0) {
                    clearInterval(quizTimer);
                    quizTimer = null;
                    answerQuiz(-1, 0, 0); // ì‹œê°„ ì´ˆê³¼
                }
            }, 1000);
        }

        // í€´ì¦ˆ ë‹µë³€
        function answerQuiz(selected, correct, points) {
            const player = gameState.players.find(p => p.id === gameState.currentPlayer);
            const currentSpace = player.position;
            
            // ì‹œê°„ ì´ˆê³¼ ì²˜ë¦¬
            if (selected === -1) {
                showMessage('ì‹œê°„ ì´ˆê³¼! ì ìˆ˜ ì—†ìŒ');
            } else if (selected === correct) {
                player.score += points;
                
                // í€´ì¦ˆ ì¹¸ì´ê³  ì•„ì§ ì†Œìœ ìê°€ ì—†ë‹¤ë©´ êµ¬ë§¤
                if (boardSpaces.find(s => s.id === currentSpace)?.type === 'quiz' && 
                    spaceOwners[currentSpace] === null) {
                    // í”Œë ˆì´ì–´ IDë¥¼ 0ë¶€í„° ì‹œì‘í•˜ëŠ” ì¸ë±ìŠ¤ë¡œ ë³€í™˜ (1->0, 2->1, 3->2, 4->3)
                    const playerIndex = gameState.currentPlayer - 1;
                    buySpace(playerIndex, currentSpace);
                    showMessage(`ì •ë‹µ! +${points}ì  íšë“! ì¹¸ ${currentSpace}ì„ êµ¬ë§¤í–ˆìŠµë‹ˆë‹¤!`);
                } else {
                    showMessage(`ì •ë‹µ! +${points}ì  íšë“!`);
                }
            } else {
                showMessage('í‹€ë ¸ìŠµë‹ˆë‹¤! ì ìˆ˜ ì—†ìŒ');
            }
            closeQuiz();
        }

        // í€´ì¦ˆ ë‹«ê¸°
        function closeQuiz() {
            // íƒ€ì´ë¨¸ ì •ë¦¬
            if (quizTimer) {
                clearInterval(quizTimer);
                quizTimer = null;
            }
            
            document.getElementById('quizPopup').classList.remove('show');
            // ìë™ìœ¼ë¡œ í„´ ì „í™˜
            setTimeout(() => {
                endTurn();
            }, 1500); // 1.5ì´ˆ í›„ ìë™ í„´ ì „í™˜
        }

        // í˜„ì¬ í™©ê¸ˆ ì—´ì‡  ì´ë²¤íŠ¸ ì €ì¥ ë³€ìˆ˜
        let currentGoldenKeyEvent = null;

        // í™©ê¸ˆ ì—´ì‡  ì´ë²¤íŠ¸ í‘œì‹œ
        function showGoldenKeyEvent() {
            const event = goldenKeyEvents[Math.floor(Math.random() * goldenKeyEvents.length)];
            currentGoldenKeyEvent = event;
            
            const popup = document.getElementById('goldenKeyPopup');
            const titleEl = document.getElementById('eventTitle');
            const contentEl = document.getElementById('eventContent');

            titleEl.textContent = event.name;
            contentEl.innerHTML = `<p>${event.description}</p>`;

            popup.classList.add('show');

            // ì‹ ë¹„í•œ ìƒì ì´ë²¤íŠ¸ê°€ ì•„ë‹Œ ê²½ìš°ì—ë§Œ ìë™ íš¨ê³¼ ì ìš©
            if (event.name !== "ğŸ ì‹ ë¹„í•œ ìƒì") {
            setTimeout(() => {
                event.effect();
            }, 1000);
            }
        }

        // í™©ê¸ˆ ì—´ì‡  ë‹«ê¸°
        function closeGoldenKey() {
            document.getElementById('goldenKeyPopup').classList.remove('show');
            
            // ì‹ ë¹„í•œ ìƒì ì´ë²¤íŠ¸ì¸ ê²½ìš° ìƒì ì—´ê¸° ì²˜ë¦¬
            if (currentGoldenKeyEvent && currentGoldenKeyEvent.name === "ğŸ ì‹ ë¹„í•œ ìƒì") {
                setTimeout(() => {
                    currentGoldenKeyEvent.effect();
                    currentGoldenKeyEvent = null; // ì´ë²¤íŠ¸ ì´ˆê¸°í™”
                }, 500);
            } else {
                // ë‹¤ë¥¸ ì´ë²¤íŠ¸ë“¤ì€ ê¸°ì¡´ ë°©ì‹ëŒ€ë¡œ í„´ ì „í™˜
                setTimeout(() => {
                    endTurn();
                }, 1500); // 1.5ì´ˆ í›„ ìë™ í„´ ì „í™˜
            }
        }

        // í„´ ì „í™˜ ì•Œë¦¼ í‘œì‹œ
        function showTurnNotification(message) {
            const popup = document.getElementById('turnNotificationPopup');
            const textEl = document.getElementById('turnNotificationText');
            
            textEl.textContent = message;
            popup.classList.add('show');
        }

        // í„´ ì „í™˜ ì•Œë¦¼ ë‹«ê¸°
        function closeTurnNotification() {
            document.getElementById('turnNotificationPopup').classList.remove('show');
        }

        // í„´ ì¢…ë£Œ (ìë™ í„´ ì „í™˜)
        function endTurn() {
            const previousPlayer = gameState.currentPlayer;
            gameState.currentPlayer = gameState.currentPlayer === 4 ? 1 : gameState.currentPlayer + 1;
            gameState.gamePhase = 'rolling';
            gameState.diceValue = 0;

            // ë¬¼ìŒí‘œë¡œ ë°”ê¾¸ì§€ ì•Šê³  í˜„ì¬ ì£¼ì‚¬ìœ„ ê°’ ìœ ì§€
            document.getElementById('rollDiceBtn').disabled = false;

            // í„´ ì „í™˜ íŒì—… í‘œì‹œ
            showTurnNotification(`í”Œë ˆì´ì–´ ${gameState.currentPlayer}ì˜ ì°¨ë¡€ì…ë‹ˆë‹¤.`);

            updateUI();
        }

        // UI ì—…ë°ì´íŠ¸
        function updateUI() {
            // í”Œë ˆì´ì–´ ì •ë³´ ì—…ë°ì´íŠ¸
            gameState.players.forEach(player => {
                document.getElementById(`score${player.id}`).textContent = player.score;
            });

            // í˜„ì¬ í”Œë ˆì´ì–´ í•˜ì´ë¼ì´íŠ¸
            updatePlayerHighlight();

            // ì£¼ì‚¬ìœ„ í‘œì‹œ (ìƒˆë¡œìš´ SVG ì‹œìŠ¤í…œ)
            if (gameState.diceValue) {
                updateDiceIcon(gameState.diceValue);
            }

            updatePlayerPieces();
        }

        // í”Œë ˆì´ì–´ í•˜ì´ë¼ì´íŠ¸ ì—…ë°ì´íŠ¸
        function updatePlayerHighlight() {
            // ëª¨ë“  í”Œë ˆì´ì–´ ì¹´ë“œì—ì„œ active í´ë˜ìŠ¤ ì œê±°
            document.querySelectorAll('.player-info').forEach(card => {
                card.classList.remove('active');
            });

            // í˜„ì¬ í”Œë ˆì´ì–´ ì¹´ë“œì— active í´ë˜ìŠ¤ ì¶”ê°€
            const currentPlayerCard = document.getElementById(`player${gameState.currentPlayer}-info`);
            if (currentPlayerCard) {
                currentPlayerCard.classList.add('active');
            }
        }

        // ë©”ì‹œì§€ í‘œì‹œ (ê°œì„ ëœ ì•Œë¦¼)
        function showMessage(message) {
            // ê¸°ì¡´ ì•Œë¦¼ ì œê±°
            const existingNotification = document.querySelector('.game-notification');
            if (existingNotification) {
                existingNotification.remove();
            }

            // ìƒˆë¡œìš´ ì•Œë¦¼ ìƒì„±
            const notification = document.createElement('div');
            notification.className = 'game-notification';
            notification.textContent = message;
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                left: 50%;
                transform: translateX(-50%);
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                padding: 15px 25px;
                border-radius: 25px;
                font-size: 16px;
                font-weight: bold;
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
                z-index: 2000;
                animation: slideDown 0.3s ease-out;
            `;

            // CSS ì• ë‹ˆë©”ì´ì…˜ ì¶”ê°€
            if (!document.querySelector('#notification-styles')) {
                const style = document.createElement('style');
                style.id = 'notification-styles';
                style.textContent = `
                    @keyframes slideDown {
                        from { 
                            opacity: 0; 
                            transform: translateX(-50%) translateY(-20px); 
                        }
                        to { 
                            opacity: 1; 
                            transform: translateX(-50%) translateY(0); 
                        }
                    }
                `;
                document.head.appendChild(style);
            }

            document.body.appendChild(notification);

            // 3ì´ˆ í›„ ìë™ ì œê±°
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.style.animation = 'slideDown 0.3s ease-out reverse';
                    setTimeout(() => {
                        if (notification.parentNode) {
                            notification.remove();
                        }
                    }, 300);
                }
            }, 3000);
        }

        // ì¹¸ í´ë¦­ ì²˜ë¦¬
        function handleSpaceClick(spaceId) {
            // ì¹¸ í´ë¦­ ì‹œ ì •ë³´ í‘œì‹œ (ì„ íƒì‚¬í•­)
            const space = boardSpaces.find(s => s.id === spaceId);
            if (space) {
                showMessage(`${space.name} (${space.type})`);
            }
        }

        // ì „ì²´í™”ë©´ í† ê¸€ í•¨ìˆ˜
        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                // ì „ì²´í™”ë©´ ì§„ì…
                document.documentElement.requestFullscreen().then(() => {
                    document.body.classList.add('fullscreen-mode');
                    document.getElementById('fullscreenIcon').classList.add('minimize');
                    document.getElementById('fullscreenBtn').title = 'ì „ì²´í™”ë©´ í•´ì œ';
                }).catch(err => {
                    // ì „ì²´í™”ë©´ ì§„ì… ì‹¤íŒ¨
                });
            } else {
                // ì „ì²´í™”ë©´ í•´ì œ
                document.exitFullscreen().then(() => {
                    document.body.classList.remove('fullscreen-mode');
                    document.getElementById('fullscreenIcon').classList.remove('minimize');
                    document.getElementById('fullscreenBtn').title = 'ì „ì²´í™”ë©´ í† ê¸€';
                }).catch(err => {
                    // ì „ì²´í™”ë©´ í•´ì œ ì‹¤íŒ¨
                });
            }
        }

        // ì„¤ì • ì°½ ì—´ê¸° í•¨ìˆ˜
        function openSettings() {
            const modal = document.getElementById('settingsModal');
            if (modal) {
                modal.style.display = 'flex';
            } else {
                createSettingsModal();
            }
        }

        function closeSettings() {
            const modal = document.getElementById('settingsModal');
            if (modal) {
                modal.style.display = 'none';
            }
        }

        function createSettingsModal() {
            const modal = document.createElement('div');
            modal.id = 'settingsModal';
            modal.className = 'settings-modal';
            modal.innerHTML = `
                <div class="settings-container">
                    <div class="settings-header">
                        <h2>âš™ï¸ ê²Œì„ ì„¤ì •</h2>
                        <button class="close-btn" onclick="closeSettings()">âœ•</button>
                    </div>
                    <div class="settings-content">
                        <div class="settings-sidebar">
                            <div class="sidebar-item active" onclick="selectSettingsTab('color')">
                                ğŸ¨ ìƒ‰ìƒ
                            </div>
                            <div class="sidebar-item" onclick="selectSettingsTab('sound')">
                                ğŸ”Š ì‚¬ìš´ë“œ
                            </div>
                            <div class="sidebar-item" onclick="selectSettingsTab('game')">
                                ğŸ® ê²Œì„
                            </div>
                            <div class="sidebar-item" onclick="selectSettingsTab('display')">
                                ğŸ“± í™”ë©´
                            </div>
                        </div>
                        <div class="settings-main">
                            <div class="settings-panel active" id="color-panel">
                                <h3>ğŸ¨ ìƒ‰ìƒ ì„¤ì •</h3>
                                <div class="color-settings-layout">
                                    <div class="palette-selection">
                                        <div class="setting-group">
                                            <label>íŒ”ë ˆíŠ¸ ì„ íƒ</label>
                                            <div class="palette-list" id="paletteList">
                                                <!-- íŒ”ë ˆíŠ¸ê°€ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
                                            </div>
                                        </div>
                                    </div>
                                    <div class="palette-preview">
                                        <h4>ë¯¸ë¦¬ë³´ê¸°</h4>
                                        <div class="mini-board-container">
                                            <div class="mini-board" id="miniBoard">
                                                <!-- ë¯¸ë‹ˆ ë³´ë“œê°€ ì—¬ê¸°ì— ìƒì„±ë©ë‹ˆë‹¤ -->
                                            </div>
                                        </div>
                                        <div class="palette-info">
                                            <div class="palette-name" id="selectedPaletteName">ì˜¤ì…˜ í†¤</div>
                                            <div class="palette-theme" id="selectedPaletteTheme">ë°”ë‹¤ ëŠë‚Œ, ì‹œì›í•˜ê³  ê¹”ë”í•¨</div>
                                            <div class="palette-colors" id="selectedPaletteColors">
                                                <div class="color-item">
                                                    <span class="color-swatch" style="background: #FF5722;"></span>
                                                    <span>í”Œë ˆì´ì–´ 1</span>
                                                </div>
                                                <div class="color-item">
                                                    <span class="color-swatch" style="background: #3F51B5;"></span>
                                                    <span>í”Œë ˆì´ì–´ 2</span>
                                                </div>
                                                <div class="color-item">
                                                    <span class="color-swatch" style="background: #4CAF50;"></span>
                                                    <span>í”Œë ˆì´ì–´ 3</span>
                                                </div>
                                                <div class="color-item">
                                                    <span class="color-swatch" style="background: #FF9800;"></span>
                                                    <span>í”Œë ˆì´ì–´ 4</span>
                                                </div>
                                            </div>
                                        </div>
                                            <div class="preview-actions">
                                                <button class="btn-apply" onclick="applySelectedPalette()">ì ìš©</button>
                                            </div>
                                    </div>
                                </div>
                            </div>
                            <div class="settings-panel" id="sound-panel">
                                <h3>ğŸ”Š ì‚¬ìš´ë“œ ì„¤ì •</h3>
                                <div class="setting-group">
                                    <label>íš¨ê³¼ìŒ ë³¼ë¥¨</label>
                                    <input type="range" min="0" max="100" value="80" class="volume-slider">
                                    <span class="volume-value">80%</span>
                                </div>
                                <div class="setting-group">
                                    <label>ë°°ê²½ìŒì•… ë³¼ë¥¨</label>
                                    <input type="range" min="0" max="100" value="60" class="volume-slider">
                                    <span class="volume-value">60%</span>
                                </div>
                                <div class="setting-group">
                                    <label><input type="checkbox"> ìŒì†Œê±°</label>
                                </div>
                            </div>
                            <div class="settings-panel" id="game-panel">
                                <h3>ğŸ® ê²Œì„ ì„¤ì •</h3>
                                <div class="setting-group">
                                    <label><input type="checkbox"> ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼</label>
                                </div>
                                <div class="setting-group">
                                    <label><input type="checkbox"> ìë™ í„´ ì „í™˜</label>
                                </div>
                            </div>
                            <div class="settings-panel" id="display-panel">
                                <h3>ğŸ“± í™”ë©´ ì„¤ì •</h3>
                                <div class="setting-group">
                                    <label><input type="checkbox"> ì „ì²´í™”ë©´ ëª¨ë“œ</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
            // DOMì´ ì™„ì „íˆ ë Œë”ë§ëœ í›„ íŒ”ë ˆíŠ¸ ë¡œë“œ
            setTimeout(() => {
                loadPalettes();
                const newModal = document.getElementById('settingsModal');
                if (newModal) {
                    newModal.style.display = 'flex';
                }
            }, 100);
        }

        function selectSettingsTab(tabName) {
            // ëª¨ë“  íƒ­ ë¹„í™œì„±í™”
            document.querySelectorAll('.sidebar-item').forEach(item => {
                item.classList.remove('active');
            });
            document.querySelectorAll('.settings-panel').forEach(panel => {
                panel.classList.remove('active');
            });
            
            // ì„ íƒëœ íƒ­ í™œì„±í™”
            event.target.classList.add('active');
            document.getElementById(tabName + '-panel').classList.add('active');
        }

        // íŒ”ë ˆíŠ¸ ë°ì´í„°ë¥¼ JavaScript ë³€ìˆ˜ë¡œ ì§ì ‘ í¬í•¨
        const palettesData = {
            "palettes": [
                {
                    "id": 0,
                    "name": "íŒ”ë ˆíŠ¸ 1 - ì˜¤ì…˜ í†¤",
                    "theme": "ë°”ë‹¤ ëŠë‚Œ, ì‹œì›í•˜ê³  ê¹”ë”í•¨",
                    "colors": {
                        "golden": "#FFD700",
                        "corner": "#4682B4",
                        "quiz": "#00CED1",
                        "special": "#6495ED",
                        "complete": "#FF7F50",
                        "center": "#E0F6FF",
                        "normal": "#B0E0E6",
                        "background": "#F0F8FF"
                    },
                    "playerColors": ["#1976D2", "#E65100", "#2E7D32", "#9C27B0"]
                },
                {
                    "id": 1,
                    "name": "íŒ”ë ˆíŠ¸ 2 - ë¹„ë¹„ë“œ í†¤",
                    "theme": "ìƒë™ê° ìˆê³  ë°ì€ ëŠë‚Œ, ë†’ì€ ëŒ€ë¹„",
                    "colors": {
                        "golden": "#FFD700",
                        "corner": "#1E90FF",
                        "quiz": "#32CD32",
                        "special": "#8A2BE2",
                        "complete": "#FF6347",
                        "center": "#FFE4B5",
                        "normal": "#87CEEB",
                        "background": "#F0F8FF"
                    },
                    "playerColors": ["#9C27B0", "#FFC107", "#00E676", "#FF9800"]
                },
                {
                    "id": 2,
                    "name": "íŒ”ë ˆíŠ¸ 3 - ëª¨ë˜ ë¼ì´íŠ¸",
                    "theme": "ì„¸ë ¨ë˜ê³  ë°ì€ ëŠë‚Œ, í˜„ëŒ€ì ",
                    "colors": {
                        "golden": "#FFD700",
                        "corner": "#4682B4",
                        "quiz": "#20B2AA",
                        "special": "#9370DB",
                        "complete": "#FF6B6B",
                        "center": "#F8F9FA",
                        "normal": "#E3F2FD",
                        "background": "#FAFAFA"
                    },
                    "playerColors": ["#C2185B", "#FF5722", "#9C27B0", "#F57C00"]
                },
                {
                    "id": 3,
                    "name": "íŒ”ë ˆíŠ¸ 4 - ì›œ ë¼ì´íŠ¸",
                    "theme": "ë”°ëœ»í•˜ê³  ë°ì€ ëŠë‚Œ, ì•„ëŠ‘í•¨",
                    "colors": {
                        "golden": "#FFD700",
                        "corner": "#FF8C00",
                        "quiz": "#00CED1",
                        "special": "#DA70D6",
                        "complete": "#FF1493",
                        "center": "#FFF8DC",
                        "normal": "#F0E68C",
                        "background": "#FFFACD"
                    },
                    "playerColors": ["#4CAF50", "#1976D2", "#FF9800", "#7B1FA2"]
                },
                {
                    "id": 4,
                    "name": "íŒ”ë ˆíŠ¸ 5 - ì¿¨ ë¼ì´íŠ¸",
                    "theme": "ì‹œì›í•˜ê³  ì°¨ë¶„í•œ ëŠë‚Œ, ì§‘ì¤‘ë ¥ í–¥ìƒ",
                    "colors": {
                        "golden": "#FFD700",
                        "corner": "#4169E1",
                        "quiz": "#00FA9A",
                        "special": "#6A5ACD",
                        "complete": "#FF69B4",
                        "center": "#F0FFFF",
                        "normal": "#E0FFFF",
                        "background": "#F0F8FF"
                    },
                    "playerColors": ["#FF9800", "#E65100", "#E91E63", "#795548"]
                },
                {
                    "id": 5,
                    "name": "íŒ”ë ˆíŠ¸ 6 - ë„¤ì´ì²˜ í†¤",
                    "theme": "ìì—°ìŠ¤ëŸ½ê³  í¸ì•ˆí•œ ëŠë‚Œ, íë§",
                    "colors": {
                        "golden": "#FFD700",
                        "corner": "#8FBC8F",
                        "quiz": "#90EE90",
                        "special": "#DDA0DD",
                        "complete": "#F0A0A0",
                        "center": "#F5FFFA",
                        "normal": "#E0FFE0",
                        "background": "#F0FFF0"
                    },
                    "playerColors": ["#795548", "#1976D2", "#607D8B", "#7B1FA2"]
                },
                {
                    "id": 6,
                    "name": "íŒ”ë ˆíŠ¸ 7 - íŒŒìŠ¤í…” í†¤",
                    "theme": "ë¶€ë“œëŸ½ê³  ë°ì€ ëŠë‚Œ, ì–´ë¦°ì´ ì¹œí™”ì ",
                    "colors": {
                        "golden": "#FFD700",
                        "corner": "#E6E6FA",
                        "quiz": "#B0E0E6",
                        "special": "#98FB98",
                        "complete": "#FFB6C1",
                        "center": "#F0F8FF",
                        "normal": "#FFFACD",
                        "background": "#F5F5F5"
                    },
                    "playerColors": ["#D32F2F", "#1976D2", "#388E3C", "#7B1FA2"]
                },
                {
                    "id": 7,
                    "name": "íŒ”ë ˆíŠ¸ 8 - ì„ ì…‹ í†¤",
                    "theme": "ì¼ëª° ëŠë‚Œ, ë”°ëœ»í•˜ê³  ë¡œë§¨í‹±",
                    "colors": {
                        "golden": "#FFD700",
                        "corner": "#FF8C00",
                        "quiz": "#FFA500",
                        "special": "#FF6347",
                        "complete": "#FF4500",
                        "center": "#FFF8DC",
                        "normal": "#FFE4B5",
                        "background": "#FFFACD"
                    },
                    "playerColors": ["#4A148C", "#FFC107", "#C2185B", "#FF5722"]
                },
                {
                    "id": 8,
                    "name": "íŒ”ë ˆíŠ¸ 9 - ë¼ë²¤ë” í†¤",
                    "theme": "ë³´ë¼ìƒ‰ ê³„ì—´, ìš°ì•„í•˜ê³  ê³ ê¸‰ìŠ¤ëŸ¬ì›€",
                    "colors": {
                        "golden": "#FFD700",
                        "corner": "#9370DB",
                        "quiz": "#DDA0DD",
                        "special": "#BA55D3",
                        "complete": "#FF69B4",
                        "center": "#F8F8FF",
                        "normal": "#E6E6FA",
                        "background": "#F0F0FF"
                    },
                    "playerColors": ["#FF5722", "#607D8B", "#1976D2", "#795548"]
                },
                {
                    "id": 9,
                    "name": "íŒ”ë ˆíŠ¸ 10 - ë¯¼íŠ¸ í†¤",
                    "theme": "ë¯¼íŠ¸ìƒ‰ ê³„ì—´, ì‹ ì„ í•˜ê³  ê¹”ë”í•¨",
                    "colors": {
                        "golden": "#FFD700",
                        "corner": "#20B2AA",
                        "quiz": "#00FA9A",
                        "special": "#40E0D0",
                        "complete": "#00CED1",
                        "center": "#F0FFFF",
                        "normal": "#E0FFFF",
                        "background": "#F5FFFA"
                    },
                    "playerColors": ["#FF5722", "#9C27B0", "#1976D2", "#795548"]
                },
                {
                    "id": 10,
                    "name": "íŒ”ë ˆíŠ¸ 11 - ì½”ë„ í†¤",
                    "theme": "ì½”ë„ìƒ‰ ê³„ì—´, í™œê¸°ì°¨ê³  ìƒë™ê°",
                    "colors": {
                        "golden": "#FFD700",
                        "corner": "#FF7F50",
                        "quiz": "#FF6347",
                        "special": "#FF69B4",
                        "complete": "#FF1493",
                        "center": "#FFF0F5",
                        "normal": "#FFE4E1",
                        "background": "#FFF5EE"
                    },
                    "playerColors": ["#4CAF50", "#FFC107", "#2E7D32", "#7B1FA2"]
                },
                {
                    "id": 11,
                    "name": "íŒ”ë ˆíŠ¸ 12 - í¬ë ˆìŠ¤íŠ¸ í†¤",
                    "theme": "ìˆ² ëŠë‚Œ, ìì—°ìŠ¤ëŸ½ê³  ì•ˆì •ê°",
                    "colors": {
                        "golden": "#FFD700",
                        "corner": "#228B22",
                        "quiz": "#32CD32",
                        "special": "#9ACD32",
                        "complete": "#ADFF2F",
                        "center": "#F0FFF0",
                        "normal": "#E0FFE0",
                        "background": "#F5FFFA"
                    },
                    "playerColors": ["#FF5722", "#1976D2", "#7B1FA2", "#E65100"]
                }
            ]
        };

        // í˜„ì¬ ê²Œì„íŒì— ì ìš©ëœ íŒ”ë ˆíŠ¸ë¥¼ ì°¾ëŠ” í•¨ìˆ˜
        function getCurrentPalette() {
            const currentStartColor = getComputedStyle(document.documentElement).getPropertyValue('--color-start').trim();
            const currentQuizColor = getComputedStyle(document.documentElement).getPropertyValue('--color-quiz').trim();
            
            // í˜„ì¬ ìƒ‰ìƒê³¼ ì¼ì¹˜í•˜ëŠ” íŒ”ë ˆíŠ¸ ì°¾ê¸°
            for (let i = 0; i < palettesData.palettes.length; i++) {
                const palette = palettesData.palettes[i];
                if (palette.colors.golden === currentStartColor && palette.colors.quiz === currentQuizColor) {
                    return i; // íŒ”ë ˆíŠ¸ ì¸ë±ìŠ¤ ë°˜í™˜
                }
            }
            return 0; // ê¸°ë³¸ê°’ìœ¼ë¡œ ì²« ë²ˆì§¸ íŒ”ë ˆíŠ¸ ë°˜í™˜
        }

        function loadPalettes() {
            try {
                const paletteList = document.getElementById('paletteList');
                
                if (paletteList && palettesData.palettes) {
                    paletteList.innerHTML = '';
                    
                    // í˜„ì¬ ì ìš©ëœ íŒ”ë ˆíŠ¸ ì¸ë±ìŠ¤ ê°€ì ¸ì˜¤ê¸°
                    const currentPaletteIndex = getCurrentPalette();
                    
                    palettesData.palettes.forEach((palette, index) => {
                        const paletteItem = document.createElement('div');
                        paletteItem.className = 'palette-item';
                        
                        // í˜„ì¬ íŒ”ë ˆíŠ¸ì¸ ê²½ìš° active í´ë˜ìŠ¤ ì¶”ê°€
                        if (index === currentPaletteIndex) {
                            paletteItem.classList.add('active');
                            selectedPalette = palette; // í˜„ì¬ íŒ”ë ˆíŠ¸ë¥¼ ì„ íƒëœ íŒ”ë ˆíŠ¸ë¡œ ì„¤ì •
                        }
                        
                        paletteItem.innerHTML = `
                            <div class="palette-name">${palette.name.replace('íŒ”ë ˆíŠ¸ ', '').replace(/^\d+\s*-\s*/, '')}</div>
                        `;
                        paletteItem.onclick = () => selectPalette(index, palette);
                        paletteList.appendChild(paletteItem);
                    });
                    
                    // í˜„ì¬ íŒ”ë ˆíŠ¸ë¡œ ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸
                    if (selectedPalette) {
                        updatePreview(selectedPalette);
                    }
                }
            } catch (error) {
                // íŒ”ë ˆíŠ¸ ë¡œë”© ì‹¤íŒ¨
            }
        }

        let selectedPalette = null;

        function selectPalette(index, palette) {
            // ëª¨ë“  íŒ”ë ˆíŠ¸ ì•„ì´í…œì—ì„œ active í´ë˜ìŠ¤ ì œê±°
            document.querySelectorAll('.palette-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // ì„ íƒëœ íŒ”ë ˆíŠ¸ì— active í´ë˜ìŠ¤ ì¶”ê°€
            event.currentTarget.classList.add('active');
            
            // ì„ íƒëœ íŒ”ë ˆíŠ¸ ì €ì¥
            selectedPalette = palette;
            
            // ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸
            updatePreview(palette);
        }

        function updatePreview(palette) {
            // íŒ”ë ˆíŠ¸ ì •ë³´ ì—…ë°ì´íŠ¸ (ë²ˆí˜¸ ì œê±°)
            const displayName = palette.name.replace(/íŒ”ë ˆíŠ¸ \d+ - /, '');
            document.getElementById('selectedPaletteName').textContent = displayName;
            document.getElementById('selectedPaletteTheme').textContent = palette.theme;
            
            // íŒ”ë ˆíŠ¸ë³„ í”Œë ˆì´ì–´ ìƒ‰ìƒ ìŠ¤ì™€ì¹˜ ì—…ë°ì´íŠ¸ (BoardColorTest.htmlê³¼ ë™ì¼)
            const colorItems = document.querySelectorAll('#selectedPaletteColors .color-item');
            const playerColors = [
                { color: palette.playerColors[0], name: 'í”Œë ˆì´ì–´ 1' },
                { color: palette.playerColors[1], name: 'í”Œë ˆì´ì–´ 2' },
                { color: palette.playerColors[2], name: 'í”Œë ˆì´ì–´ 3' },
                { color: palette.playerColors[3], name: 'í”Œë ˆì´ì–´ 4' }
            ];
            
            colorItems.forEach((item, index) => {
                if (playerColors[index]) {
                    const swatch = item.querySelector('.color-swatch');
                    const name = item.querySelector('span:last-child');
                    swatch.style.background = playerColors[index].color;
                    name.textContent = playerColors[index].name;
                }
            });
            
            // ë¯¸ë‹ˆ ë³´ë“œ ì—…ë°ì´íŠ¸
            updateMiniBoard(palette);
        }

        function updateMiniBoard(palette) {
            const miniBoard = document.getElementById('miniBoard');
            if (!miniBoard) return;
            
            // ë¯¸ë‹ˆ ë³´ë“œ ìƒì„± (7x7 ê·¸ë¦¬ë“œ)
            miniBoard.innerHTML = '';
            
            // 7x7 ë°”ë‘‘íŒ ëª¨ì–‘ìœ¼ë¡œ ìƒ‰ìƒ ë°°ì¹˜
            const boardLayout = [
                ['golden', 'normal', 'normal', 'normal', 'normal', 'normal', 'corner'],
                ['normal', 'center', 'center', 'center', 'center', 'center', 'normal'],
                ['normal', 'center', 'center', 'center', 'center', 'center', 'normal'],
                ['normal', 'center', 'center', 'center', 'center', 'center', 'normal'],
                ['normal', 'center', 'center', 'center', 'center', 'center', 'normal'],
                ['normal', 'center', 'center', 'center', 'center', 'center', 'normal'],
                ['corner', 'normal', 'normal', 'normal', 'normal', 'normal', 'golden']
            ];
            
            let cellNumber = 1;
            boardLayout.forEach((row, rowIndex) => {
                row.forEach((cellType, colIndex) => {
                    const miniSpace = document.createElement('div');
                    miniSpace.className = 'mini-space';
                    
                    // ì¹¸ ë²ˆí˜¸ë³„ ìƒ‰ìƒ ë§¤í•‘
                    let color;
                    if ([1, 7, 43, 49].includes(cellNumber)) {
                        // ëª¨ì„œë¦¬ ì¹¸
                        color = palette.colors.corner;
                    } else if ([4, 22, 28, 46].includes(cellNumber)) {
                        // í™©ê¸ˆì—´ì‡  ì¹¸
                        color = palette.colors.golden;
                    } else if ([2, 3, 5, 6, 8, 15, 29, 36, 14, 21, 35, 42, 44, 45, 47, 48].includes(cellNumber)) {
                        // í€´ì¦ˆ ì¹¸
                        color = palette.colors.quiz;
                    } else {
                        // ë³´ë“œ ì¤‘ì•™ ì¹¸ (ë‚˜ë¨¸ì§€)
                        color = palette.colors.center;
                    }
                    
                    miniSpace.style.backgroundColor = color;
                    
                    miniBoard.appendChild(miniSpace);
                    cellNumber++;
                });
            });
        }

        function applySelectedPalette() {
            if (selectedPalette) {
                applyPalette(selectedPalette);
                // ì„¤ì • ì°½ì€ ë‹«ì§€ ì•Šê³  ìœ ì§€
            }
        }

        function applyPalette(palette) {
            // CSS ë³€ìˆ˜ ì—…ë°ì´íŠ¸
            document.documentElement.style.setProperty('--color-start', palette.colors.golden);
            document.documentElement.style.setProperty('--color-quiz', palette.colors.quiz);
            document.documentElement.style.setProperty('--color-golden', palette.colors.golden);
            document.documentElement.style.setProperty('--color-special', palette.colors.special);
            document.documentElement.style.setProperty('--color-corner', palette.colors.corner);
            document.documentElement.style.setProperty('--color-center', palette.colors.center);
            document.documentElement.style.setProperty('--color-background', palette.colors.background);
            document.documentElement.style.setProperty('--color-normal', palette.colors.normal);
            
            // íŒ”ë ˆíŠ¸ë³„ í”Œë ˆì´ì–´ ìƒ‰ìƒ CSS ë³€ìˆ˜ ì„¤ì • (BoardColorTest.htmlê³¼ ë™ì¼)
            palette.playerColors.forEach((color, index) => {
                document.documentElement.style.setProperty(`--player-color-${index + 1}`, color);
            });
            
            // í”Œë ˆì´ì–´ ìƒ‰ìƒ ì—…ë°ì´íŠ¸ (íŒ”ë ˆíŠ¸ë³„ ìƒ‰ìƒ ì‚¬ìš©)
            palette.playerColors.forEach((color, index) => {
                if (gameState.players[index]) {
                    gameState.players[index].color = color;
                }
            });
            
            // ë³´ë“œ ë‹¤ì‹œ ê·¸ë¦¬ê¸°
            createBoard();
            updateUI();
            
            // ë³´ë“œ ì¬ìƒì„± í›„ ë ì§€ ìƒ‰ìƒê³¼ ì†Œìœ ê¶Œ í‘œì‹œ ì—…ë°ì´íŠ¸
            setTimeout(() => {
                updateRibbonColors();
                updateLandOwnershipDisplay();
            }, 100);
        }

        // ì „ì²´í™”ë©´ ìƒíƒœ ë³€í™” ê°ì§€ (ESC í‚¤ ë“±ìœ¼ë¡œ í•´ì œë  ë•Œ)
        document.addEventListener('fullscreenchange', () => {
            if (!document.fullscreenElement) {
                document.body.classList.remove('fullscreen-mode');
                document.getElementById('fullscreenIcon').classList.remove('minimize');
                document.getElementById('fullscreenBtn').title = 'ì „ì²´í™”ë©´ í† ê¸€';
            }
        });

        // F11 í‚¤ ì§€ì› (ì„ íƒì‚¬í•­)
        document.addEventListener('keydown', (event) => {
            if (event.key === 'F11') {
                event.preventDefault();
                toggleFullscreen();
            }
        });

        // ê²Œì„ ì‹œì‘
        window.onload = function() {
            initGame();
        };
    </script>
</body>
</html>
